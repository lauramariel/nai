{
    "status": {},
    "spec": {
        "name": "nai-on-nkp-v2-5",
        "description": "Version: NAI 2.5 on NKP 2.16.1\n\n[NAI Dashboard](@@{Admin.NAI_UI_ENDPOINT}@@)\n\nObjects Info:\n- Objects Browser: @@{Admin.OBJECTS_URL}@@\n- Access Key: @@{Admin.SHARED_OBJECTS_ACCESS_KEY}@@\n- Secret Key: @@{Admin.SHARED_OBJECTS_SECRET_KEY}@@\n    ",
        "resources": {
            "service_definition_list": [
                {
                    "name": "Admin",
                    "description": "Admin machine",
                    "variable_list": [
                        {
                            "type": "LOCAL",
                            "name": "NKP_DASHBOARD_URL",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": ""
                        },
                        {
                            "type": "LOCAL",
                            "name": "NKP_DASHBOARD_USERNAME",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": ""
                        },
                        {
                            "type": "LOCAL",
                            "name": "NKP_DASHBOARD_PASSWORD",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": ""
                        },
                        {
                            "type": "LOCAL",
                            "name": "NUS_FS_UUID",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": ""
                        },
                        {
                            "type": "LOCAL",
                            "name": "NAI_UI_ENDPOINT",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": ""
                        },
                        {
                            "type": "LOCAL",
                            "name": "ISTIO_INGRESS_HOST",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": ""
                        },
                        {
                            "type": "LOCAL",
                            "name": "NGINX_INGRESS_HOST",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": ""
                        },
                        {
                            "type": "LOCAL",
                            "name": "NUS_OBJ_INSTANCE_IP_ADDRESS",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": ""
                        },
                        {
                            "type": "LOCAL",
                            "name": "SHARED_OBJECTS_ACCESS_KEY",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": ""
                        },
                        {
                            "type": "LOCAL",
                            "name": "SHARED_OBJECTS_SECRET_KEY",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": ""
                        },
                        {
                            "type": "LOCAL",
                            "name": "OBJECTS_URL",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": ""
                        }
                    ],
                    "action_list": [
                        {
                            "type": "system",
                            "name": "action_create",
                            "description": "System action for creating an application",
                            "runbook": {
                                "name": "Admin___create___runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin___create___dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin___create___dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": true
                        },
                        {
                            "type": "system",
                            "name": "action_start",
                            "description": "System action for starting an application",
                            "runbook": {
                                "name": "Admin___start___runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin___start___dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin___start___dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": true
                        },
                        {
                            "type": "system",
                            "name": "action_stop",
                            "description": "System action for stopping an application",
                            "runbook": {
                                "name": "Admin___stop___runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin___stop___dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin___stop___dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": true
                        },
                        {
                            "type": "system",
                            "name": "action_delete",
                            "description": "System action for deleting an application. Deletes created VMs as well",
                            "runbook": {
                                "name": "Admin___delete___runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin___delete___dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "Delete NKP clusters",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Cleanup Objects",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "CALL_RUNBOOK",
                                        "name": "Delete NKP clusters",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "runbook_reference": {
                                                "name": "Admin_NkpDeleteClusters_runbook",
                                                "kind": "app_runbook"
                                            },
                                            "inarg_list": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "CALL_RUNBOOK",
                                        "name": "Cleanup Objects",
                                        "description": "",
                                        "attrs": {
                                            "type": "CALL_RUNBOOK",
                                            "runbook_reference": {
                                                "name": "cab3d388_runbook",
                                                "kind": "app_runbook"
                                            },
                                            "inarg_list": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin___delete___dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": true
                        },
                        {
                            "type": "system",
                            "name": "action_restart",
                            "description": "System action for restarting an application",
                            "runbook": {
                                "name": "Admin___restart___runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin___restart___dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin___restart___dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": true
                        },
                        {
                            "type": "system",
                            "name": "action_soft_delete",
                            "description": "System action for deleting an application. Does not delete created VMs",
                            "runbook": {
                                "name": "Admin___soft_delete___runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin___soft_delete___dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin___soft_delete___dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": true
                        },
                        {
                            "type": "user",
                            "name": "InstallDeps",
                            "description": "",
                            "runbook": {
                                "name": "Admin_InstallDeps_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin_InstallDeps_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": [
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Install NKP CLI",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Create environment variables",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                }
                                            ]
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "Add SSH key",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Install NKP CLI",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Create environment variables",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Add SSH key",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nif [ ! -f ~/.ssh/id_rsa ]; then\n    echo '@@{CRED_SSH.secret}@@' > ~/.ssh/id_rsa\n    chmod 600 ~/.ssh/id_rsa\n\n    echo '@@{CRED_SSH.public_key}@@' > ~/.ssh/id_rsa.pub\nfi\n",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Install NKP CLI",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\ncat <<EOF >~/.env\nexport NKP_BINARY_URL='@@{NKP_BINARY_URL}@@'\nEOF\n\nsource ~/.env\n\n# Download and install DKP binary\n# curl \"https://downloads.d2iq.com/dkp/${DKP_VERSION}/dkp_${DKP_VERSION}_linux_amd64.tar.gz\" -o dkp.tar.gz\n\n\n# Download and install NKP binary\ncurl -fsSL \"${NKP_BINARY_URL}\" | sudo tar xz -C /usr/local/bin -- nkp\n\nnkp version",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Create environment variables",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\necho \"Creating .env file\"\ncat <<EOF >>~/.env\n# NKP\nexport NKP_VERSION=$(nkp version -o=json |jq -r '.nkp.gitVersion')\nexport CLUSTER_NAME=\"@@{CLUSTER_NAME}@@\"\nexport NUTANIX_USER=\"@@{CRED_PC.username}@@\"\nexport NUTANIX_PASSWORD=\"@@{CRED_PC.secret}@@\"\nexport NUTANIX_ENDPOINT=\"@@{PC_ADDRESS}@@\"\nexport NUTANIX_PORT=\"@@{PC_PORT}@@\"\nexport MGMT_LB_IP_RANGE_STARTS=\"@@{MGMT_LB_IP_RANGE_STARTS}@@\"\nexport MGMT_LB_IP_RANGE_ENDS=\"@@{MGMT_LB_IP_RANGE_ENDS}@@\"\nexport CONTROL_PLANE_VIP_ADDRESS=\"@@{CONTROL_PLANE_VIP_ADDRESS}@@\"\nexport NUTANIX_MACHINE_TEMPLATE_IMAGE_NAME=\"@@{MACHINE_TEMPLATE_IMAGE_NAME}@@\"\nexport NUTANIX_PRISM_ELEMENT_CLUSTER_NAME=\"@@{PRISM_ELEMENT_CLUSTER_NAME}@@\"\nexport NUTANIX_SUBNET_NAME=\"@@{SUBNET_NAME}@@\"\nexport NUTANIX_STORAGE_CONTAINER_NAME=\"@@{STORAGE_CONTAINER_NAME}@@\"\nexport REGISTRY_MIRROR_URL=\"@@{CONTAINER_REGISTRY_MIRROR}@@\"\nexport NAI_IMAGE_REGISTRY=\"@@{NAI_IMAGE_REGISTRY}@@\"\nexport REGISTRY_USERNAME=\"@@{CONTAINER_REGISTRY_USERNAME}@@\"\nexport NO_COLOR=1\nexport MGMT_LB_IP_RANGE_USERS_STARTS=\"@@{MGMT_LB_IP_RANGE_USERS_STARTS}@@\"\nexport MGMT_LB_IP_RANGE_USERS_ENDS=\"@@{MGMT_LB_IP_RANGE_USERS_ENDS}@@\"\n# LDAP\nexport DOMAIN=@@{DOMAIN}@@\nexport BINDDN='@@{BINDDN}@@'\nexport BINDPW='@@{BINDPW}@@'\nexport LDAP_HOST=@@{LDAP_HOST}@@\nexport LDAP_PORT='@@{LDAP_PORT}@@'\nexport NO_SSL='@@{NO_SSL}@@'\nexport SKIP_SSL_VERIFICATION='@@{SKIP_SSL_VERIFICATION}@@'\nexport START_TLS='@@{START_TLS}@@'\nexport LDAP_SEARCH_USERS='@@{LDAP_SEARCH_USERS}@@'\nexport LDAP_SEARCH_GROUPS='@@{LDAP_SEARCH_GROUPS}@@'\n# Management Workspace\nexport MANAGEMENT_WORKSPACE_APPS='@@{MANAGEMENT_WORKSPACE_APPS}@@'\n# Default Workspace\nexport INFRA_PROVIDER_NAME=pc\nexport DEFAULT_WORKSPACE_APPS='@@{DEFAULT_WORKSPACE_APPS}@@'\n# CSI Files\nexport PE_VIP_ADDRESS=@@{PE_VIP_ADDRESS}@@\nexport NUS_FS_NAME=@@{NUS_FS_NAME}@@\nexport NUS_FS_API_USER=@@{NUS_FS_API_USER}@@\nexport NUS_FS_API_PASSWORD=@@{NUS_FS_API_PASSWORD}@@\nexport FILES_CREDS_STRING=\"@@{NUS_FS_NAME}@@.ntnxlab.local:@@{NUS_FS_API_USER}@@:@@{NUS_FS_API_PASSWORD}@@\"\n# NAI\nexport NAI_CORE_VERSION=\"@@{NAI_CORE_VERSION}@@\"\nexport NKP_WORKSPACE=kommander-workspace\nexport NKP_NAMESPACE=kommander\n# Objects\nexport NUS_OBJ_NAME=\"@@{NUS_OBJ_NAME}@@\"\nexport OBJ_CONFIG_SCRIPT=\"@@{OBJ_CONFIG_SCRIPT}@@\"\n# Sizing\nexport NO_OF_USERS=\"@@{NO_OF_USERS}@@\"\nexport NO_OF_WORKER_NODES=\"@@{NO_OF_WORKER_NODES}@@\"\nEOF\n\necho \"Creating .secrets file\"\ncat <<EOF >>~/.secrets\nexport REGISTRY_PASSWORD=\"@@{CONTAINER_REGISTRY_PASSWORD}@@\"\nexport NAI_DEFAULT_PW=\"@@{NAI_DEFAULT_PW}@@\"\nexport NAI_NEW_ADMIN_PW=\"@@{NAI_NEW_ADMIN_PW}@@\"\nexport HF_TOKEN=\"@@{HF_TOKEN}@@\"\nexport LICENSE_KEY=\"@@{NAI_LICENSE_KEY}@@\"\nexport LICENSE_CLUSTER_UUID=\"@@{NAI_LICENSE_UUID}@@\"\nexport NAI_NEW_USER_PW=\"@@{NAI_NEW_USER_PW}@@\"\nexport PC_ADDRESS=\"@@{PC_ADDRESS}@@\"\nexport PC_PORT=\"@@{PC_PORT}@@\"\nexport PC_USERNAME=\"@@{CRED_PC.username}@@\" \nexport PC_PASSWORD=\"@@{CRED_PC.secret}@@\"\nexport DOMAIN=\"@@{DOMAIN}@@\"\nEOF",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin_InstallDeps_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "ConfigureFiles",
                            "description": "",
                            "runbook": {
                                "name": "Admin_ConfigureFiles_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin_ConfigureFiles_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": [
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Get NUS FS uuid",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Create NUS FS API user",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Create NUS FS API user",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Create FS StorageClass manifest",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                }
                                            ]
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "Get NUS FS uuid",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Create NUS FS API user",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Create FS StorageClass manifest",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "SET_VARIABLE",
                                        "name": "Get NUS FS uuid",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "PC_ADDRESS = \"@@{PC_ADDRESS}@@\"\nPC_PORT = \"@@{PC_PORT}@@\"\nPC_USERNAME = \"@@{CRED_PC.username}@@\" \nPC_PASSWORD = \"@@{CRED_PC.secret}@@\"\nNUS_FS_NAME = \"@@{NUS_FS_NAME}@@\"\n\nimport requests, base64\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\n\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n\nBASIC_AUTH = \"{}:{}\".format(PC_USERNAME,PC_PASSWORD).encode(\"utf-8\")\nB64_AUTH = base64.b64encode(BASIC_AUTH).decode()\n\nPC_URL = \"https://{}:{}\".format(PC_ADDRESS,PC_PORT)\n\nHEADERS = {\n    \"Authorization\": \"Basic {}\".format(B64_AUTH),\n    \"Content-Type\": \"application/json\"\n}\n\ndef get_fs_uuid_by_name(fs_name):\n    api_endpoint = \"/\".join([\n        PC_URL,\n        \"api/files/v4.0.a2/config/file-servers?$filter=name eq '{}'\".format(fs_name),\n        ]\n    )\n\n    try:\n        resp = requests.get(\n            url=api_endpoint,\n            headers=HEADERS,\n            verify=False\n        )\n        resp.raise_for_status()\n\n        data = resp.json()\n\n        if len(data[\"data\"]) == 1:\n            return data[\"data\"][0][\"extId\"]\n        else:\n            raise Exception(\"File server not found.\")\n\n\n    except requests.exceptions.HTTPError as err:\n        print(resp.text)\n        raise Exception(err)\n\nprint(\"NUS_FS_UUID={}\".format(get_fs_uuid_by_name(NUS_FS_NAME)))",
                                            "script_type": "static_py3",
                                            "exit_status": [],
                                            "eval_scope": "local",
                                            "eval_variables": [
                                                "NUS_FS_UUID"
                                            ]
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Create NUS FS API user",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "PC_ADDRESS = \"@@{PC_ADDRESS}@@\"\nPC_PORT = \"@@{PC_PORT}@@\"\nPC_USERNAME = \"@@{CRED_PC.username}@@\"\nPC_PASSWORD = \"@@{CRED_PC.secret}@@\"\nNUS_FS_UUID = \"@@{NUS_FS_UUID}@@\"\nNUS_FS_API_USER = \"@@{NUS_FS_API_USER}@@\"\nNUS_FS_API_PASSWORD = \"@@{NUS_FS_API_PASSWORD}@@\"\n\n\n#from time import sleep as sleep # Ignore this line when copy/paste to Escript\n\nimport requests, base64\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\n\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n\nBASIC_AUTH = \"{}:{}\".format(PC_USERNAME,PC_PASSWORD).encode(\"utf-8\")\nB64_AUTH = base64.b64encode(BASIC_AUTH).decode()\n\nPC_URL = \"https://{}:{}\".format(PC_ADDRESS,PC_PORT)\n\nHEADERS = {\n    \"Authorization\": \"Basic {}\".format(B64_AUTH),\n    \"Content-Type\": \"application/json\"\n}\n\ndef retry_task(task_function, max_retries=3, base_delay=1, max_delay=10, *args, **kwargs):\n    retries = 0\n    delay = base_delay\n    while retries < max_retries:\n        try:\n            result = task_function(*args, **kwargs)\n            return result  # If the task succeeds, return its result\n        except Exception as e:\n            print(\"Attempt {} failed:\".format(retries + 1), e)\n            retries += 1\n            if retries < max_retries:\n                print(\"Retrying...\")\n                sleep(delay)  # Wait for the current delay\n                delay = min(delay * 2, max_delay)  # Exponential backoff\n    raise Exception(\"Task failed after {} attempts\".format(max_retries))\n\ndef create_api_user(fs_uuid, user, password):\n    payload = {\n        \"name\": user,\n        \"password\": password\n    }\n\n    api_endpoint = \"/\".join([\n        PC_URL,\n        \"api/files/v4.0.a4/config/file-servers\",\n        fs_uuid,\n        \"users\",]\n    )\n\n    try:\n        resp = requests.post(\n            url=api_endpoint,\n            json=payload,\n            headers=HEADERS,\n            verify=False\n        )\n        resp.raise_for_status()\n\n        return \"Created user: {}\".format(user)\n\n    except requests.exceptions.HTTPError as err:\n        error_group = resp.json().get(\"data\", {}).get(\"error\", [{}])[0].get(\"errorGroup\", \"\")\n        if error_group == \"USER_ALREADY_EXISTS\":\n            return \"USER_ALREADY_EXISTS\"\n        print(resp.text)\n        raise Exception(err)\n\ntry:\n    result = retry_task(create_api_user, max_retries=10, base_delay=2, max_delay=15, fs_uuid=NUS_FS_UUID, user=NUS_FS_API_USER, password=NUS_FS_API_PASSWORD)\n    print(result)\nexcept Exception as err:\n    print(\"Error:\", err)\n    raise Exception(err)\n\n",
                                            "script_type": "static_py3",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Create FS StorageClass manifest",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\n\ncat <<EOF > ~/files_sc.yaml\napiVersion: v1\nkind: Secret\nmetadata:\n  name: nutanix-csi-credentials-files\n  namespace: ntnx-system\ntype: Opaque\nstringData:\n# Provide Nutanix Prism Element credentials which is a default UI credential separated by colon in \"key:\".\n# Provide Nutanix File Server credentials which is a REST API user created on File server UI separated by colon in \"files-key:\".\n  key: \"$PE_VIP_ADDRESS:$NUTANIX_PORT:$NUTANIX_USER:$NUTANIX_PASSWORD\"\n  files-key: \"$NUS_FS_NAME.$DOMAIN:$NUS_FS_API_USER:$NUS_FS_API_PASSWORD\"\n---\nallowVolumeExpansion: true\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: nutanix-files\nparameters:\n  dynamicProv: ENABLED\n  nfsServerName: $NUS_FS_NAME\n  nfsServer: $NUS_FS_NAME.$DOMAIN\n  csi.storage.k8s.io/controller-expand-secret-name: nutanix-csi-credentials-files\n  csi.storage.k8s.io/controller-expand-secret-namespace: ntnx-system\n  csi.storage.k8s.io/node-publish-secret-name: nutanix-csi-credentials-files\n  csi.storage.k8s.io/node-publish-secret-namespace: ntnx-system\n  csi.storage.k8s.io/provisioner-secret-name: nutanix-csi-credentials-files\n  csi.storage.k8s.io/provisioner-secret-namespace: ntnx-system\n  storageType: NutanixFiles\nprovisioner: csi.nutanix.com\nEOF",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin_ConfigureFiles_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "InstallNkpCluster",
                            "description": "",
                            "runbook": {
                                "name": "Admin_InstallNkpCluster_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin_InstallNkpCluster_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "Create NKP management cluster",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Create NKP management cluster",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\nsource ~/.secrets\n\ntime nkp create cluster nutanix -c $CLUSTER_NAME \\\n--bootstrap-cluster-image $REGISTRY_MIRROR_URL/mesosphere/konvoy-bootstrap:$NKP_VERSION \\\n--endpoint https://$NUTANIX_ENDPOINT:$NUTANIX_PORT \\\n--insecure \\\n--control-plane-replicas 1 \\\n--control-plane-vcpus 8 \\\n--control-plane-memory 32 \\\n--worker-replicas $NO_OF_WORKER_NODES \\\n--worker-vcpus 32 \\\n--worker-memory 64 \\\n--vm-image $NUTANIX_MACHINE_TEMPLATE_IMAGE_NAME \\\n--kubernetes-service-load-balancer-ip-range $MGMT_LB_IP_RANGE_STARTS-$MGMT_LB_IP_RANGE_ENDS \\\n--control-plane-endpoint-ip $CONTROL_PLANE_VIP_ADDRESS \\\n--control-plane-prism-element-cluster $NUTANIX_PRISM_ELEMENT_CLUSTER_NAME \\\n--control-plane-subnets $NUTANIX_SUBNET_NAME \\\n--worker-prism-element-cluster $NUTANIX_PRISM_ELEMENT_CLUSTER_NAME \\\n--worker-subnets $NUTANIX_SUBNET_NAME \\\n--csi-storage-container $NUTANIX_STORAGE_CONTAINER_NAME \\\n--registry-mirror-url http://$REGISTRY_MIRROR_URL \\\n--registry-mirror-username $REGISTRY_USERNAME \\\n--registry-mirror-password $REGISTRY_PASSWORD \\\n--ssh-public-key-file  ~/.ssh/id_rsa.pub \\\n--csi-hypervisor-attached-volumes=false \\\n--self-managed\n\nmkdir -p ~/.kube\ncp $CLUSTER_NAME.conf ~/.kube/config",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin_InstallNkpCluster_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "ConfigureNkpCluster",
                            "description": "",
                            "runbook": {
                                "name": "Admin_ConfigureNkpCluster_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin_ConfigureNkpCluster_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": [
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Install NKP license",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Enable applications",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Install NKP license",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Disable unneeded apps",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                }
                                            ]
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "Configure IDP LDAP",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Install NKP license",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Add LB IPs",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Create Files SC",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Enable applications",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Disable unneeded apps",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Configure IDP LDAP",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\n\ncat <<EOF | kubectl apply -f -\napiVersion: dex.mesosphere.io/v1alpha1\nkind: Connector\nmetadata:\n  name: nutanix-ldap-identity-provider\n  namespace: kommander\nspec:\n  displayName: ${DOMAIN}\n  enabled: true\n  ldap:\n    bindDN: ${BINDDN}\n    bindPW: ${BINDPW}\n    host: ${LDAP_HOST}:${LDAP_PORT}\n    insecureNoSSL: ${NO_SSL}\n    insecureSkipVerify: ${SKIP_SSL_VERIFICATION}\n    startTLS: ${START_TLS}\n    userSearch:\n      baseDN: ${LDAP_SEARCH_USERS}\n      emailAttr: userPrincipalName\n      emailSuffix: \"\"\n      filter: (objectClass=person)\n      idAttr: DN\n      nameAttr: cn\n      scope: sub\n      username: sAMAccountName\n    groupSearch:\n      baseDN: ${LDAP_SEARCH_GROUPS}\n      filter: (objectClass=group)\n      nameAttr: cn\n      scope: \"\"\n      userMatchers:\n      - groupAttr: member\n        userAttr: DN\n  type: ldap\nEOF\n\ncat <<EOF | kubectl apply -f -\napiVersion: kommander.mesosphere.io/v1beta1\nkind: VirtualGroup\nmetadata:\n  annotations:\n    kommander.mesosphere.io/display-name: ntnxlab-ssp-admins\n  name: ntnxlab-ssp-admins\nspec:\n  subjects:\n  - apiGroup: rbac.authorization.k8s.io\n    kind: Group\n    name: \"oidc:SSP Admins\"\n---\napiVersion: kommander.mesosphere.io/v1beta1\nkind: VirtualGroupClusterRoleBinding\nmetadata:\n  name: ntnxlab-ssp-admins-cluster-federated-admin\nspec:\n  clusterRoleRef:\n    name: kommander-cluster-federated-admin\n  placement:\n    clusterSelector: {}\n  virtualGroupRef:\n    name: ntnxlab-ssp-admins\nEOF",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Install NKP license",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\n\ncat <<EOF | kubectl apply -f -\napiVersion: v1\nkind: Secret\nmetadata:\n  labels:\n    kommanderType: license\n  name: nutanix-license\n  namespace: kommander\nstringData:\n  nutanix-license-key: @@{NKP_LICENSE_KEY}@@\n---\napiVersion: kommander.mesosphere.io/v1beta1\nkind: License\nmetadata:\n  name: nutanix-license\n  namespace: kommander\nspec:\n  nutanixLicenseRef:\n    name: nutanix-license\nEOF",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Add LB IPs",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\n\nkubectl --namespace metallb-system patch ipaddresspool metallb --type='json' -p='[\n  {\n    \"op\": \"add\",\n    \"path\": \"/spec/addresses/-\",\n    \"value\": \"'\"${MGMT_LB_IP_RANGE_USERS_STARTS}-${MGMT_LB_IP_RANGE_USERS_ENDS}\"'\"\n  }\n]'\n\n\n",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Create Files SC",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "source ~/.env\nkubectl apply -f files_sc.yaml",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Enable applications",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\n\nsource ~/.env\n\n# Loop through each app and execute the command\nfor app in $MANAGEMENT_WORKSPACE_APPS; do\n    appdeployment_name=$(echo \"$app\" | cut -d',' -f1)\n    app_name=$(echo \"$app\" | cut -d',' -f2)\n\n    # Execute the command\n    echo \"nkp create appdeployment $appdeployment_name --app $app_name -w kommander-workspace\"\n    nkp create appdeployment \"$appdeployment_name\" --app \"$app_name\" -w kommander-workspace\n    sleep 1\ndone\n\n",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Disable unneeded apps",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\n\nsource ~/.env\n\nNS=kommander\nNAME=ai-navigator-app\nKIND=appdeployment\n\necho \"Waiting for $KIND/$NAME to be created in namespace $NS...\"\n\n# Wait until the resource exists\nuntil kubectl -n \"$NS\" get \"$KIND\" \"$NAME\" >/dev/null 2>&1; do\n  sleep 5\ndone\n\necho \"$KIND/$NAME found, deleting...\"\nkubectl -n \"$NS\" delete \"$KIND\" \"$NAME\"",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin_ConfigureNkpCluster_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "NotUsed_ConfigureDefaultWorkspace",
                            "description": "",
                            "runbook": {
                                "name": "Admin_ConfigureDefaultWorkspace_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin_ConfigureDefaultWorkspace_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": [
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Enable applications",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Create workload cluster 01",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Enable applications",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Create workload cluster 02",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                }
                                            ]
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "Configure Infrastructure provider",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Enable applications",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Create workload cluster 01",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Create workload cluster 02",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Configure Infrastructure provider",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\n\nkubectl create secret generic $INFRA_PROVIDER_NAME -n kommander-default-workspace \\\n  --from-literal=prismURL=https://$NUTANIX_ENDPOINT:$NUTANIX_PORT \\\n  --from-literal=username=$NUTANIX_USER \\\n  --from-literal=password=$NUTANIX_PASSWORD \\\n  --from-literal=additionalTrustBundle=\"\" \\\n  --from-literal=insecure=true\nkubectl label secret $INFRA_PROVIDER_NAME -n kommander-default-workspace dkp-infrastructure-provider-type=nutanix-secret",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Enable applications",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\n\nsource ~/.env\n\n# Loop through each app and execute the command\nfor app in $DEFAULT_WORKSPACE_APPS; do\n    appdeployment_name=$(echo \"$app\" | cut -d',' -f1)\n    app_name=$(echo \"$app\" | cut -d',' -f2)\n\n    # Execute the command\n    echo \"nkp create appdeployment $appdeployment_name --app $app_name -w default-workspace\"\n    nkp create appdeployment \"$appdeployment_name\" --app \"$app_name\" -w default-workspace\ndone\n",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Create workload cluster 01",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\n\nnkp create cluster nutanix -c workload01 \\\n-n kommander-default-workspace \\\n--endpoint https://$NUTANIX_ENDPOINT:$NUTANIX_PORT \\\n--insecure \\\n--control-plane-vcpus 8 \\\n--control-plane-memory 32 \\\n--worker-vcpus 16 \\\n--worker-memory 64 \\\n--control-plane-endpoint-ip $WL01_CONTROL_PLANE_VIP_ADDRESS \\\n--control-plane-prism-element-cluster $NUTANIX_PRISM_ELEMENT_CLUSTER_NAME \\\n--control-plane-subnets $WL01_NUTANIX_SUBNET_NAME \\\n--csi-storage-container $NUTANIX_STORAGE_CONTAINER_NAME \\\n--kubernetes-service-load-balancer-ip-range $WL01_LB_IP_RANGE_STARTS-$WL01_LB_IP_RANGE_ENDS \\\n--worker-prism-element-cluster $NUTANIX_PRISM_ELEMENT_CLUSTER_NAME \\\n--worker-subnets $WL01_NUTANIX_SUBNET_NAME \\\n--registry-mirror-url https://$REGISTRY_MIRROR_URL \\\n--ssh-public-key-file  ~/.ssh/id_rsa.pub \\\n--vm-image $NUTANIX_MACHINE_TEMPLATE_IMAGE_NAME\n\nkubectl -n kommander-default-workspace label cluster workload01 infraId=$INFRA_PROVIDER_NAME\n\nnkp get kubeconfig -c workload01 -n kommander-default-workspace > workload01.conf\n\nkubectl --kubeconfig workload01.conf apply -f files_sc.yaml\n\nkubectl --kubeconfig workload01.conf --namespace metallb-system patch ipaddresspool metallb --type='json' -p='[\n  {\n    \"op\": \"add\",\n    \"path\": \"/spec/addresses/-\",\n    \"value\": \"'\"${WL01_LB_IP_RANGE_USERS_STARTS}-${WL01_LB_IP_RANGE_USERS_ENDS}\"'\"\n  }\n]'",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Create workload cluster 02",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\n\nsleep 15\n\nnkp create cluster nutanix -c workload02 \\\n-n kommander-default-workspace \\\n--endpoint https://$NUTANIX_ENDPOINT:$NUTANIX_PORT \\\n--insecure \\\n--control-plane-vcpus 8 \\\n--control-plane-memory 32 \\\n--worker-vcpus 16 \\\n--worker-memory 64 \\\n--control-plane-endpoint-ip $WL02_CONTROL_PLANE_VIP_ADDRESS \\\n--control-plane-prism-element-cluster $NUTANIX_PRISM_ELEMENT_CLUSTER_NAME \\\n--control-plane-subnets $WL02_NUTANIX_SUBNET_NAME \\\n--csi-storage-container $NUTANIX_STORAGE_CONTAINER_NAME \\\n--kubernetes-service-load-balancer-ip-range $WL02_LB_IP_RANGE_STARTS-$WL02_LB_IP_RANGE_ENDS \\\n--worker-prism-element-cluster $NUTANIX_PRISM_ELEMENT_CLUSTER_NAME \\\n--worker-subnets $WL02_NUTANIX_SUBNET_NAME \\\n--registry-mirror-url https://$REGISTRY_MIRROR_URL \\\n--ssh-public-key-file  ~/.ssh/id_rsa.pub \\\n--vm-image $NUTANIX_MACHINE_TEMPLATE_IMAGE_NAME\n\nkubectl -n kommander-default-workspace label cluster workload02 infraId=$INFRA_PROVIDER_NAME\n\nnkp get kubeconfig -c workload02 -n kommander-default-workspace > workload02.conf\n\nkubectl --kubeconfig workload02.conf apply -f files_sc.yaml\n\nkubectl --kubeconfig workload02.conf --namespace metallb-system patch ipaddresspool metallb --type='json' -p='[\n  {\n    \"op\": \"add\",\n    \"path\": \"/spec/addresses/-\",\n    \"value\": \"'\"${WL02_LB_IP_RANGE_USERS_STARTS}-${WL02_LB_IP_RANGE_USERS_ENDS}\"'\"\n  }\n]'",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin_ConfigureDefaultWorkspace_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "GetDashboardAccess",
                            "description": "",
                            "runbook": {
                                "name": "Admin_GetDashboardAccess_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin_GetDashboardAccess_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "NKP Dashboard Access",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "SET_VARIABLE",
                                        "name": "NKP Dashboard Access",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/bin/bash\n\nset -e\n\nkubectl patch deployment kommander-kommander-ui \\\n  -n kommander \\\n  --type='json' \\\n  -p='[{\"op\": \"replace\", \"path\": \"/spec/template/spec/containers/0/resources/limits/cpu\", \"value\": \"4\"},\n       {\"op\": \"replace\", \"path\": \"/spec/template/spec/containers/0/resources/limits/memory\", \"value\": \"4Gi\"}]'\n\nNKP_DASHBOARD_URL=$(kubectl -n kommander get svc kommander-traefik -o go-template='https://{{with index .status.loadBalancer.ingress 0}}{{or .hostname .ip}}{{end}}/dkp/kommander/dashboard{{ \"\\n\"}}')\nNKP_DASHBOARD_USERNAME=$(kubectl -n kommander get secret dkp-credentials -o go-template='{{.data.username|base64decode}}')\nNKP_DASHBOARD_PASSWORD=$(kubectl -n kommander get secret dkp-credentials -o go-template='{{.data.password|base64decode}}')\n\ncat <<EOF >>~/.env\nexport NKP_DASHBOARD_URL=${NKP_DASHBOARD_URL}\nexport NKP_DASHBOARD_USERNAME=${NKP_DASHBOARD_USERNAME}\nexport NKP_DASHBOARD_PASSWORD=${NKP_DASHBOARD_PASSWORD}\nEOF\n\necho \"NKP_DASHBOARD_URL=${NKP_DASHBOARD_URL}\"\necho \"NKP_DASHBOARD_USERNAME=${NKP_DASHBOARD_USERNAME}\"\necho \"NKP_DASHBOARD_PASSWORD=${NKP_DASHBOARD_PASSWORD}\"",
                                            "script_type": "sh",
                                            "exit_status": [],
                                            "eval_scope": "local",
                                            "eval_variables": [
                                                "NKP_DASHBOARD_URL",
                                                "NKP_DASHBOARD_USERNAME",
                                                "NKP_DASHBOARD_PASSWORD"
                                            ]
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin_GetDashboardAccess_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "PackageInstall",
                            "description": "",
                            "runbook": {
                                "name": "Admin_PackageInstall_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin_PackageInstall_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": [
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Install NKP dependencies",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Configure Files for StorageClass",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Configure Files for StorageClass",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Install NKP management cluster",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Install NKP management cluster",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Configure NKP cluster",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Configure NKP cluster",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "InstallNAI",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Configure NKP cluster",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "NKP dashboard access details",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "InstallNAI",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Configure Objects",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Configure Objects",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "InstallAISoftware",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Install Tools",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Install NKP dependencies",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "InstallAISoftware",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Delete Secrets",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                }
                                            ]
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "Install Tools",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Install NKP dependencies",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Configure Files for StorageClass",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Install NKP management cluster",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Configure NKP cluster",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "InstallNAI",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "NKP dashboard access details",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Configure Objects",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "InstallAISoftware",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Delete Secrets",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "CALL_RUNBOOK",
                                        "name": "Install Tools",
                                        "description": "",
                                        "attrs": {
                                            "type": "CALL_RUNBOOK",
                                            "runbook_reference": {
                                                "name": "1f200b8c_runbook",
                                                "kind": "app_runbook"
                                            },
                                            "inarg_list": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "CALL_RUNBOOK",
                                        "name": "Install NKP dependencies",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "runbook_reference": {
                                                "name": "Admin_InstallDeps_runbook",
                                                "kind": "app_runbook"
                                            },
                                            "inarg_list": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "CALL_RUNBOOK",
                                        "name": "Configure Files for StorageClass",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "runbook_reference": {
                                                "name": "Admin_ConfigureFiles_runbook",
                                                "kind": "app_runbook"
                                            },
                                            "inarg_list": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "CALL_RUNBOOK",
                                        "name": "Install NKP management cluster",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "runbook_reference": {
                                                "name": "Admin_InstallNkpCluster_runbook",
                                                "kind": "app_runbook"
                                            },
                                            "inarg_list": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "CALL_RUNBOOK",
                                        "name": "Configure NKP cluster",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "runbook_reference": {
                                                "name": "Admin_ConfigureNkpCluster_runbook",
                                                "kind": "app_runbook"
                                            },
                                            "inarg_list": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "CALL_RUNBOOK",
                                        "name": "InstallNAI",
                                        "description": "",
                                        "attrs": {
                                            "type": "CALL_RUNBOOK",
                                            "runbook_reference": {
                                                "name": "3b3d6a94_runbook",
                                                "kind": "app_runbook"
                                            },
                                            "inarg_list": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "CALL_RUNBOOK",
                                        "name": "NKP dashboard access details",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "runbook_reference": {
                                                "name": "Admin_GetDashboardAccess_runbook",
                                                "kind": "app_runbook"
                                            },
                                            "inarg_list": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "CALL_RUNBOOK",
                                        "name": "Configure Objects",
                                        "description": "",
                                        "attrs": {
                                            "type": "CALL_RUNBOOK",
                                            "runbook_reference": {
                                                "name": "d7b831fa_runbook",
                                                "kind": "app_runbook"
                                            },
                                            "inarg_list": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "CALL_RUNBOOK",
                                        "name": "InstallAISoftware",
                                        "description": "",
                                        "attrs": {
                                            "type": "CALL_RUNBOOK",
                                            "runbook_reference": {
                                                "name": "36358e51_runbook",
                                                "kind": "app_runbook"
                                            },
                                            "inarg_list": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Delete Secrets",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "rm ~/.secrets",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin_PackageInstall_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "NkpDeleteClusters",
                            "description": "",
                            "runbook": {
                                "name": "Admin_NkpDeleteClusters_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "Admin_NkpDeleteClusters_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "Delete management cluster",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Delete management cluster",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\n\nnkp delete cluster -c $CLUSTER_NAME --self-managed",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "Admin_NkpDeleteClusters_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "InstallNAI",
                            "description": "",
                            "runbook": {
                                "name": "3b3d6a94_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "5aa2e727_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": [
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "InstallNAIDeps",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "InstallNAI",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "InstallNAI",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "PostInstall",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "PostInstall",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "SetupNAI",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "SetupNAI",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "CreateNAIUsers",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                }
                                            ]
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "InstallNAIDeps",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "InstallNAI",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "PostInstall",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "SetupNAI",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "CreateNAIUsers",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "InstallNAIDeps",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\nsource ~/.secrets\n\nexport REGISTRY_EMAIL=\"tme@nutanix.com\"\n\n# Create secrets\nkubectl create ns envoy-gateway-system --dry-run=client -o yaml | kubectl apply -f -\nkubectl create secret docker-registry registry-image-pull-secret \\\n  --docker-server=$NAI_IMAGE_REGISTRY \\\n  --docker-username=$REGISTRY_USERNAME \\\n  --docker-password=$REGISTRY_PASSWORD \\\n  --docker-email=$REGISTRY_EMAIL \\\n  -n envoy-gateway-system\n\nkubectl create ns kserve --dry-run=client -o yaml | kubectl apply -f -\nkubectl create secret docker-registry registry-image-pull-secret \\\n  --docker-server=$NAI_IMAGE_REGISTRY \\\n  --docker-username=$REGISTRY_USERNAME \\\n  --docker-password=$REGISTRY_PASSWORD \\\n  --docker-email=$REGISTRY_EMAIL \\\n  -n kserve\n\nkubectl create ns opentelemetry --dry-run=client -o yaml | kubectl apply -f -\nkubectl create secret docker-registry registry-image-pull-secret \\\n  --docker-server=$NAI_IMAGE_REGISTRY \\\n  --docker-username=$REGISTRY_USERNAME \\\n  --docker-password=$REGISTRY_PASSWORD \\\n  --docker-email=$REGISTRY_EMAIL \\\n  -n opentelemetry\n\n# Download helm charts from registry\nhelm pull oci://$NAI_IMAGE_REGISTRY/gateway-crds-helm --version v1.5.0\nhelm pull oci://$NAI_IMAGE_REGISTRY/gateway-helm --version v1.5.0\nhelm pull oci://$NAI_IMAGE_REGISTRY/kserve-crd --version v0.15.0\nhelm pull oci://$NAI_IMAGE_REGISTRY/kserve --version v0.15.0\nhelm pull oci://$NAI_IMAGE_REGISTRY/nai-core --version 2.5.0\nhelm pull oci://$NAI_IMAGE_REGISTRY/nai-operators --version 2.5.0\nhelm pull oci://$NAI_IMAGE_REGISTRY/opentelemetry-operator --version 0.93.0\n\n# Install Envoy Gateway\nhelm template eg ./gateway-crds-helm-v1.5.0.tgz --set crds.gatewayAPI.enabled=true --set crds.envoyGateway.enabled=true | kubectl apply --server-side --force-conflicts -f -\nhelm upgrade --install eg ./gateway-helm-v1.5.0.tgz \\\n    -n envoy-gateway-system --create-namespace --wait \\\n    --set global.images.envoyGateway.image=$NAI_IMAGE_REGISTRY/nutanix/nai-gateway:v1.5.0 \\\n    --set global.images.ratelimit.image=$NAI_IMAGE_REGISTRY/nutanix/nai-ratelimit:3e085e5b \\\n    --set global.imagePullSecrets[0].name=registry-image-pull-secret\n\n# Create an Envoy Proxy resource for the Envoy Gateway to pull image from local private registry\ncat <<EOF | kubectl apply -f -\napiVersion: gateway.envoyproxy.io/v1alpha1\nkind: EnvoyProxy\nmetadata:\n  name: nai-envoyproxy\n  namespace: envoy-gateway-system\nspec:\n  provider:\n    type: Kubernetes\n    kubernetes:\n      envoyDeployment:\n        pod:\n          imagePullSecrets:\n            - name: registry-image-pull-secret\n        container:\n          image: \"$NAI_IMAGE_REGISTRY/nutanix/nai-envoy:distroless-v1.35.0\"\nEOF\n\n# Install Kserve\nhelm upgrade --install kserve-crd ./kserve-crd-v0.15.0.tgz -n kserve --create-namespace --wait\nhelm upgrade --install kserve ./kserve-v0.15.0.tgz \\\n  -n kserve --wait \\\n  --set kserve.controller.deploymentMode=RawDeployment \\\n  --set kserve.controller.gateway.disableIngressCreation=true \\\n  --set kserve.controller.image=$NAI_IMAGE_REGISTRY/nutanix/nai-kserve-controller \\\n  --set kserve.controller.rbacProxyImage=$NAI_IMAGE_REGISTRY/nutanix/nai-kube-rbac-proxy:v0.18.0 \\\n  --set kserve.controller.imagePullSecrets[0].name=registry-image-pull-secret\n\n# Install OpenTelemetry Operator\nhelm upgrade --install opentelemetry-operator ./opentelemetry-operator-0.93.0.tgz \\\n  -n opentelemetry --create-namespace --wait \\\n  --set manager.image.repository=$NAI_IMAGE_REGISTRY/nutanix/nai-opentelemetry-operator \\\n  --set manager.collectorImage.repository=$NAI_IMAGE_REGISTRY/nutanix/nai-opentelemetry-collector-k8s \\\n  --set kubeRBACProxy.image.repository=$NAI_IMAGE_REGISTRY/nutanix/nai-kube-rbac-proxy \\\n  --set imagePullSecrets[0].name=registry-image-pull-secret",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "InstallNAI",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\n\n# Make sure KServe is running\necho \"Checking for Kserve\"\nuntil kubectl wait --for condition=ready pods -l app.kubernetes.io/name=kserve-controller-manager -n kserve; do sleep 2; done\n\n# Pull chart from private registry\n#export NAI_IMAGE_REGISTRY=\"registry.nutanixdemo.com\"\n#helm pull oci://$NAI_IMAGE_REGISTRY/nai/nai-core --version 2.5.0 --untar=true\n\n# We already pulled the nai-core chart in the previous step\n\n# Skip the image tag checks for private registry\n#PATCH_DATA=$(cat <<EOF\n#{\"data\":{\"registries-skipping-tag-resolving\":\"$NAI_IMAGE_REGISTRY\"}}\n#EOF\n#)\n#kubectl patch configmap config-deployment -n knative-serving --type merge -p \"$PATCH_DATA\"\n\n# Set up overrides\ncat <<EOF > ~/nai-operators-override-values.yaml \nimagePullSecret:\n  credentials:\n    registry: $NAI_IMAGE_REGISTRY\nnaiRedis:\n  naiRedisImage:\n    name: $NAI_IMAGE_REGISTRY/nutanix/nai-redis\nnaiJobs:\n  naiJobsImage:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-jobs\nnai-clickhouse-operator:\n  operator:\n    image:\n      registry: $NAI_IMAGE_REGISTRY/nutanix\n      repository: nai-clickhouse-operator\n  metrics:\n    image:\n      registry: $NAI_IMAGE_REGISTRY/nutanix\n      repository: nai-clickhouse-metrics-exporter\nai-gateway-helm:\n  extProc:\n    image:\n      repository: $NAI_IMAGE_REGISTRY/nutanix/nai-ai-gateway-extproc\n      tag: c4f26a8\n  controller:\n    image:\n      repository: $NAI_IMAGE_REGISTRY/nutanix/nai-ai-gateway-controller\n      tag: c4f26a8\nEOF\n\ncat <<EOF > ~/nai-core-override-values.yaml\nimagePullSecret:\n  credentials:\n    registry: $NAI_IMAGE_REGISTRY\nnaiIepOperator:\n  iepOperatorImage:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-iep-operator\n  modelProcessorImage:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-model-processor\nnaiInferenceUi:\n  naiUiImage:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-inference-ui\nnaiJobs:\n  naiJobsImage:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-jobs\nnaiApi:\n  naiApiImage:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-api\n  logger:\n    logLevel: debug\n  supportedTGIImage: $NAI_IMAGE_REGISTRY/nutanix/nai-tgi\n  supportedKserveRuntimeImage: $NAI_IMAGE_REGISTRY/nutanix/nai-kserve-huggingfaceserver\n  supportedVLLMImage: $NAI_IMAGE_REGISTRY/nutanix/nai-vllm\n  supportedKserveCustomModelServerRuntimeImage: $NAI_IMAGE_REGISTRY/nutanix/nai-kserve-custom-model-server\nnaiIam:\n  iamProxy:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-iam-proxy\n  iamProxyControlPlane:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-iam-proxy-control-plane\n  iamUi:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-iam-ui\n  iamUserAuthn:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-iam-user-authn\n  iamThemis:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-iam-themis\n  iamThemisBootstrap:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-iam-bootstrap\nnaiLabs:\n  labsImage:\n    image: $NAI_IMAGE_REGISTRY/nutanix/nai-rag-app\nnai-clickhouse-keeper:\n  clickhouseKeeper:\n    image:\n      registry: $NAI_IMAGE_REGISTRY/nutanix\n      repository: nai-clickhouse-keeper\noauth2-proxy:\n  image:\n    repository: $NAI_IMAGE_REGISTRY/nutanix/nai-oauth2-proxy\nnai-clickhouse-server:\n  clickhouse:\n    image:\n      registry: $NAI_IMAGE_REGISTRY/nutanix\n      repository: nai-clickhouse-server\n    initContainers:\n      addUdf:\n        image:\n          registry: $NAI_IMAGE_REGISTRY/nutanix\n          repository: nai-clickhouse-udf\n      waitForKeeper:\n        image:\n          registry: $NAI_IMAGE_REGISTRY/nutanix\n          repository: nai-jobs\nnai-clickhouse-schemas:\n  image:\n    registry: $NAI_IMAGE_REGISTRY/nutanix\n    repository: nai-clickhouse-schemas\nnaiMonitoring:\n  opentelemetry:\n    collectorImage: $NAI_IMAGE_REGISTRY/nutanix/nai-opentelemetry-collector-contrib:0.136.0\n    targetAllocator:\n      image:\n        repository: $NAI_IMAGE_REGISTRY/nutanix/nai-target-allocator\nEOF\n\n# Install nai-operators\nhelm install nai-operators ./nai-operators-2.5.0.tgz --version=2.5.0  -n nai-system --create-namespace --wait \\\n        --insecure-skip-tls-verify -f nai-operators-override-values.yaml\n\n# Wait until it's done installing\necho -n \"Waiting for redis-standalone to be created in namespace nai-system\"\nuntil kubectl wait --for condition=ready pods -l app=redis-standalone -n nai-system >/dev/null 2>&1; do echo -n \".\"; sleep 2; done; echo \" Done\"\necho -n \"Waiting for nai-clickhouse-operator to be created in namespace nai-system\"\nuntil kubectl wait --for condition=ready pods -l app.kubernetes.io/name=nai-clickhouse-operator -n nai-system >/dev/null 2>&1; do echo -n \".\"; sleep 2; done; echo \" Done\"\n\n# Install nai-core\nhelm install nai-core ./nai-core-2.5.0.tgz --version=2.5.0 -n nai-system --create-namespace --wait \\\n    --insecure-skip-tls-verify \\\n    --set naiApi.storageClassName=nutanix-files \\\n    --set naiMonitoring.opentelemetry.storageClassName=nutanix-files \\\n    --set defaultStorageClassName=nutanix-volume \\\n    --set naiMonitoring.nodeExporter.serviceMonitor.namespaceSelector.matchNames[0]=$NKP_NAMESPACE \\\n    --set naiMonitoring.dcgmExporter.serviceMonitor.namespaceSelector.matchNames[0]=$NKP_NAMESPACE \\\n    --set \"nai-clickhouse-keeper.clickhouseKeeper.resources.limits.memory=1Gi\" \\\n\t--set \"nai-clickhouse-keeper.clickhouseKeeper.resources.requests.memory=1Gi\" \\\n    -f nai-core-override-values.yaml",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "SET_VARIABLE",
                                        "name": "PostInstall",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\n\n# Make sure nai-core is up\nuntil kubectl wait pod --all --for=condition=Ready --field-selector=status.phase!=Succeeded --namespace=nai-system; do sleep 2; done\n\nGATEWAY_IP=$(kubectl get gateway -o jsonpath='{.items[].status.addresses[].value}' -n nai-system)\nNAI_UI_ENDPOINT=\"https://${GATEWAY_IP//./-}.sslip.nutanixdemo.com\"\nNAI_UI_HOSTNAME=\"${GATEWAY_IP//./-}.sslip.nutanixdemo.com\"\n# Create secret for certificates\n\n# get certs\nCERT_PATH=\"$HOME/certs/fullchain1.pem\"\nKEY_PATH=\"$HOME/certs/privkey1.pem\"\nmkdir -p $HOME/certs\nwget -O $CERT_PATH http://10.55.251.38/workshop_staging/tradeshows/configuration/certificates/sslip.nutanixdemo.com/fullchain1.pem \nwget -O $KEY_PATH http://10.55.251.38/workshop_staging/tradeshows/configuration/certificates/sslip.nutanixdemo.com/privkey1.pem\n\nCERT_NAME=\"nai-cert\"\necho \"Creating secret $CERT_NAME for certificate\"\nkubectl create secret tls -n nai-system $CERT_NAME --cert=$CERT_PATH --key=$KEY_PATH\nkubectl patch gateway nai-ingress-gateway -n nai-system --type='json' -p='[{\"op\": \"replace\", \"path\": \"/spec/listeners/1/tls/certificateRefs/0/name\", \"value\": \"nai-cert\"}]'\n\n# patch gateway to point to envoyproxy\nkubectl patch gatewayclass nai-gatewayclass \\\n  --type merge \\\n  -p '{\n    \"spec\": {\n      \"parametersRef\": {\n        \"group\": \"gateway.envoyproxy.io\",\n        \"kind\": \"EnvoyProxy\",\n        \"name\": \"nai-envoyproxy\",\n        \"namespace\": \"envoy-gateway-system\"\n      }\n    }\n  }'\n\n# Create clusterrole to fetch metrics\nkubectl patch clusterrole nai-otel-role --type='json' -p='[\n  {\n    \"op\": \"add\",\n    \"path\": \"/rules/-\",\n    \"value\": {\n      \"apiGroups\": [\"\"],\n      \"resources\": [\"services/kube-prometheus-stack-prometheus-node-exporter\"],\n      \"verbs\": [\"get\"]\n    }\n  }\n]'\n\nkubectl patch servicemonitor nai-node-exporter-monitor -n nai-system --type='json' -p='[\n  {\"op\": \"add\", \"path\": \"/spec/endpoints/0/bearerTokenFile\", \"value\": \"/var/run/secrets/kubernetes.io/serviceaccount/token\"},\n  {\"op\": \"replace\", \"path\": \"/spec/endpoints/0/scheme\", \"value\": \"https\"},\n  {\"op\": \"add\", \"path\": \"/spec/endpoints/0/tlsConfig\", \"value\": {\"insecureSkipVerify\": true}}\n]'\n\ncat <<EOF >> ~/.env\nexport NAI_UI_ENDPOINT=\"$NAI_UI_ENDPOINT\"\nEOF\n\necho \"NAI_UI_ENDPOINT=$NAI_UI_ENDPOINT\"",
                                            "script_type": "sh",
                                            "exit_status": [],
                                            "eval_scope": "local",
                                            "eval_variables": [
                                                "NAI_UI_ENDPOINT"
                                            ]
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "SetupNAI",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\n#!/bin/bash\n# Uses unsupported v1 APIs, do not use in production.\nsource ~/.secrets\nsource ~/.env\n\nexport CURL_OPTS=\"-sk\"\nexport HEADERS=\"Content-Type: application/json\"\nexport DEFAULT_AUTH=\"admin:$NAI_DEFAULT_PW\"\nexport NEW_AUTH=\"admin:$NAI_NEW_ADMIN_PW\"\n\n##### Reset password\necho -e \"Resetting password\"\nPAYLOAD=$(cat <<EOF\n{\"username\":\"admin\",\"old_password\":\"$NAI_DEFAULT_PW\",\"new_password\":\"$NAI_NEW_ADMIN_PW\"}\nEOF\n)\ncurl $CURL_OPTS -X PUT \"$NAI_UI_ENDPOINT/api/iam/authn/v1/users/password\" -H $HEADERS -u $DEFAULT_AUTH -d \"$PAYLOAD\"\n\n# sleep 1\n\n##### Accept EULA\necho -e \"\\nAccepting EULA\"\nPAYLOAD=$(cat <<EOF\n{\"eula\":{\"accepted\":true,\"name\":\"admin\",\"company\":\"Nutanix\"}}\nEOF\n)\ncurl $CURL_OPTS -X PATCH \"$NAI_UI_ENDPOINT/api/enterpriseai/v1/cluster/config\" -H $HEADERS -u $NEW_AUTH -d \"$PAYLOAD\"\n\nsleep 1\n\n##### Enable Pulse\necho -e \"\\nEnabling Pulse\"\nPAYLOAD=$(cat <<EOF\n{\"pulse\":{\"accepted\":true}}\nEOF\n)\ncurl $CURL_OPTS -X PATCH \"$NAI_UI_ENDPOINT/api/enterpriseai/v1/cluster/config\" -H $HEADERS -u $NEW_AUTH -d \"$PAYLOAD\"\n\nsleep 1\n\n##### Add License\necho -e \"\\nAdding License\"\nPAYLOAD=$(cat <<EOF\n{\"licenses\":[{\"licenseKey\":\"$LICENSE_KEY\",\"meterType\":\"GB\",\"licenseClusterUUID\":\"$LICENSE_CLUSTER_UUID\"}]}\nEOF\n)\ncurl $CURL_OPTS -X PUT \"$NAI_UI_ENDPOINT/api/enterpriseai/v1/licenses\" -H $HEADERS -u $NEW_AUTH -d \"$PAYLOAD\"\n\n##### Create HF Token\necho -e \"\\nCreating HF Token\"\nPAYLOAD=$(cat <<EOF\n{\"name\":\"hf_token\",\"data\":{\"HF_TOKEN\":\"$HF_TOKEN\"},\"type\":\"hf\"}\nEOF\n)\ncurl $CURL_OPTS -X POST \"$NAI_UI_ENDPOINT/api/enterpriseai/v1/credentials\" -H $HEADERS -u $NEW_AUTH -d \"$PAYLOAD\"\n\n##### Enable Manual Upload Option for Users\necho -e \"\\nEnable Manual Upload\"\nPAYLOAD=$(cat <<EOF\n{\"manualUpload\":{\"enabled\":true}}\nEOF\n)\ncurl $CURL_OPTS -X PATCH \"$NAI_UI_ENDPOINT/api/enterpriseai/v1/cluster/config\" -H $HEADERS -u $NEW_AUTH -d \"$PAYLOAD\"\n\n##### Enable Direct Download Option for Users\necho -e \"\\nEnable Direct Download\"\nPAYLOAD=$(cat <<EOF\n{\"hfUrlImport\": \"enabled\":true}}\nEOF\n)\ncurl $CURL_OPTS -X PATCH \"$NAI_UI_ENDPOINT/api/enterpriseai/v1/cluster/config\" -H $HEADERS -u $NEW_AUTH -d \"$PAYLOAD\"\n\n##### Enable meta-llama/Llama-3.2-1B-Instruct to be imported by users (required for bootcamp)\necho -e \"\\nEnable Import of meta-llama/Llama-3.2-1B-Instruct\"\n\necho -e \"\\n\"\necho -n \"Getting catalog ID... \"\n# First, have to get catalog ID for the one we want\ncatalog_id=$(curl $CURL_OPTS -X GET \"$NAI_UI_ENDPOINT/api/enterpriseai/v1/catalogs\" -H $HEADERS -u $NEW_AUTH | jq -r '.data.catalogs[] | select(.modelName==\"meta-llama/Llama-3.2-1B-Instruct\").id')\necho -e $catalog_id\n\necho -e \"\\nEnabling catalog ID\"\nPAYLOAD=$(cat <<EOF\n[{\"catalogId\":\"$catalog_id\",\"adminEnabled\":true}]\nEOF\n)\ncurl $CURL_OPTS -X PATCH \"$NAI_UI_ENDPOINT/api/enterpriseai/v1/catalogs\" -H $HEADERS -u $NEW_AUTH -d \"$PAYLOAD\"",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "CreateNAIUsers",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n# Uses unsupported v1 APIs, do not use in production.\nsource ~/.secrets\nsource ~/.env\n\nexport CURL_OPTS=\"-sk\"\n\nUSERS=()\n\n# Create NAI users\nfor i in $(seq 1 $NO_OF_USERS)\ndo\n  USERS+=(\"adminuser$(printf \"%02d\" $i)\")\ndone\n\necho -e \"\\nCreating users and adding to auth policy\"\n# Get auth policy UUID that matches ML User_acp\nENDPOINT=\"api/iam/v4.1.b1/authz/authorization-policies?%24filter=displayName%20eq%20%27ML%20User_acp%27\"\nACP_UUID=$(curl $CURL_OPTS -X GET \"$NAI_UI_ENDPOINT/$ENDPOINT\" -H 'Content-Type: application/json' -u \"admin:$NAI_NEW_ADMIN_PW\" | jq .data[].extId)\n\n# Get the role UUID for ML User\nENDPOINT=\"api/iam/v4.1.b1/authz/roles?%24filter=displayName%20eq%20%27ML%20User%27\"\nROLE_UUID=$(curl $CURL_OPTS -X GET \"$NAI_UI_ENDPOINT/$ENDPOINT\" -H 'Content-Type: application/json' -u \"admin:$NAI_NEW_ADMIN_PW\" | jq .data[].extId)\n\n\n# Create 5 users\nfor USER_NAI_NAME in \"${USERS[@]}\"\ndo\nPAYLOAD=$(cat <<EOF\n{\"username\":\"$USER_NAI_NAME\",\"password\":\"$NAI_NEW_USER_PW\",\"firstName\":\"Bootcamp\",\"lastName\":\"User$(cat /dev/urandom | LC_ALL=C tr -dc 'A-Za-z' | head -c 5)\",\"status\":\"ACTIVE\",\"isForceResetPasswordEnabled\":false,\"userType\":\"LOCAL\"}\nEOF\n)\necho -e \"\\nCreating user $USER_NAI_NAME\"\nUSER_UUID=$(curl $CURL_OPTS -X POST \"$NAI_UI_ENDPOINT/api/iam/v4.1.b1/authn/users\" -H 'Content-Type: application/json' -u \"admin:$NAI_NEW_ADMIN_PW\" -d \"$PAYLOAD\" | jq .data.extId )\n\necho -e \"\\nAdd user to auth policy\"\n\n# Add user to auth policy\n\n# Get existing users in auth policy. If this is adminuser01 then there are no users yet, so skip this part \nif [ \"$USER_NAI_NAME\" != \"adminuser01\" ]; then\n    ENDPOINT=\"api/iam/v4.1.b1/authz/authorization-policies/${ACP_UUID//\\\"/}\"\n    values=$(curl ${CURL_OPTS} -X GET \"$NAI_UI_ENDPOINT/$ENDPOINT\" -u \"admin:$NAI_NEW_ADMIN_PW\" | jq .data.identities[].identityFilter.user.uuid.anyof[])\n    # store in array\n    existing_users=($values)\n    USER_UUID_LIST=$(printf '%s,' \"${existing_users[@]}\")\n    # add new user to the list\n    USER_UUID_LIST=\"${USER_UUID_LIST}${USER_UUID}\"\nelse\n    USER_UUID_LIST=\"${USER_UUID}\"\nfi\n\n# Construct payload\nPAYLOAD=$(cat << EOF\n{\n\"entities\": [\n    {\n    \"\\$reserved\": {\n        \"*\": {\n        \"*\": {\n            \"eq\": \"*\"\n        }\n        }\n    }\n    }\n],\n\"displayName\": \"ML User_acp\",\n\"role\": $ROLE_UUID,\n\"identities\": [\n    {\n    \"\\$reserved\": {\n        \"user\": {\n        \"uuid\": {\n            \"anyof\": [\n            $USER_UUID_LIST\n            ]\n        }\n        }\n    }\n    }\n],\n\"extId\": $ACP_UUID,\n\"description\": \"\"\n}\nEOF\n)\n\n# Get the etag for the auth policy\nENDPOINT=\"api/iam/v4.1.b1/authz/authorization-policies/${ACP_UUID//\\\"/}\"\netag=$(curl ${CURL_OPTS}I -X GET \"$NAI_UI_ENDPOINT/$ENDPOINT\" -u \"admin:$NAI_NEW_ADMIN_PW\" | awk '/^etag:/ { print $2 }' | tr -d '\\r')\n\n# Add user to auth policy\ncurl $CURL_OPTS -X PUT \"$NAI_UI_ENDPOINT/$ENDPOINT\" -H 'Content-Type: application/json' -H \"If-Match: $etag\" -u \"admin:$NAI_NEW_ADMIN_PW\" -d \"$PAYLOAD\"\n\nsleep 1\n\necho -e \"\\nCreating HF Token for user $USER_NAI_NAME\"\nPAYLOAD=$(cat <<EOF\n{\"name\":\"hf_token\",\"data\":{\"HF_TOKEN\":\"$HF_TOKEN\"},\"type\":\"hf\"}\nEOF\n)\ncurl $CURL_OPTS -X POST \"$NAI_UI_ENDPOINT/api/enterpriseai/v1/credentials\" -H 'Content-Type: application/json' -u \"$USER_NAI_NAME:$NAI_NEW_USER_PW\" -d \"$PAYLOAD\"\nsleep 1\n\ndone",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "5aa2e727_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "InstallTools",
                            "description": "",
                            "runbook": {
                                "name": "1f200b8c_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "b99b3b4e_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "SetupTools",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "SetupTools",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "# Courtesy of https://github.com/jesse-gonzalez\n\n## install arkade to simplify installing cloud-native tools\ncurl -sLS https://get.arkade.dev| sudo sh\nsudo chown -R nutanix:nutanix /usr/local/bin/arkade\n\n## install utils\narkade get \\\nkubectx \\\nkubens \\\nkrew \\\nstern\n\n## install yq\nsudo wget https://github.com/mikefarah/yq/releases/latest/download/yq_linux_amd64 -O /usr/bin/yq\nsudo chown -R nutanix:nutanix /usr/bin/yq\nsudo chmod +x /usr/bin/yq\n\n## install k9s\ncurl -sS https://webinstall.dev/k9s | bash\n\n## set path for arkade and krew kubectl plugin binaries\nexport PATH=\"$HOME/.arkade/bin/:$HOME/.krew/bin:$PATH\"\n\necho \"alias k=$(which kubectl)\" >> $HOME/.bashrc\necho \"alias kns=$(which kubens)\" >> $HOME/.bashrc",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "b99b3b4e_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "InstallAISoftware",
                            "description": "",
                            "runbook": {
                                "name": "36358e51_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "ed89e085_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": [
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Install Ingress",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Install Flowise",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                },
                                                {
                                                    "type": "",
                                                    "from_task_reference": {
                                                        "name": "Install Flowise",
                                                        "kind": "app_task"
                                                    },
                                                    "to_task_reference": {
                                                        "name": "Install Milvus",
                                                        "kind": "app_task"
                                                    },
                                                    "edge_type": "user_defined"
                                                }
                                            ]
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "Install Ingress",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Install Flowise",
                                                "kind": "app_task"
                                            },
                                            {
                                                "name": "Install Milvus",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Install Ingress",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\n# Install ingress-nginx\nhelm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx\nhelm upgrade --install ingress-nginx ingress-nginx/ingress-nginx \\\n  --namespace ingress-nginx \\\n  --create-namespace \\\n  --set controller.replicaCount=2 \\\n  --set controller.allowSnippetAnnotations=true \\\n  --set controller.ingressClassResource.default=true \\\n  --set force-ssl-redirect=true \\\n  --version=4.8.3 \\\n  --wait\nkubectl --namespace ingress-nginx get services -o wide ingress-nginx-controller\n\nexport NGINX_INGRESS_HOST=$(kubectl get svc ingress-nginx-controller -n ingress-nginx -o jsonpath=\"{.status.loadBalancer.ingress[].ip}\" && echo)\necho \"NGINX_INGRESS_HOST=$NGINX_INGRESS_HOST\"",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Install Flowise",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n# TODO: make sure ingress is up\n\nsource ~/.env\n\n# Make sure the istio-system namespace is up\n#until kubectl get namespace istio-system &>/dev/null; do echo \"Waiting for namespace istio-system\";  sleep 2; done\n\n# INSTANCE=flowise-user#\n\necho \"Creating $NO_OF_USERS flowise instances\"\n\nfor i in $(seq 1 $NO_OF_USERS)\ndo\n  export INSTANCE=\"flowise-adminuser0$i\"\n  export INGRESS_IP=$(kubectl get svc ingress-nginx-controller -n ingress-nginx -o jsonpath=\"{.status.loadBalancer.ingress[].ip}\" && echo)\n  export SSLIP_HOSTNAME=\"${INSTANCE}-${INGRESS_IP//./-}.sslip.nutanixdemo.com\"\n\n  kubectl create namespace ${INSTANCE} --dry-run=client -o yaml | kubectl apply -f -\n\n  # use the existing certificate\n  kubectl get secret -n nai-system nai-cert -o yaml | sed \"s/namespace: nai-system/namespace: ${INSTANCE}/g\" | kubectl apply -f -\n  kubectl get secret nai-cert -n ${INSTANCE}\n\n  # install flowise\n  helm repo add cowboysysop https://cowboysysop.github.io/charts/\n  helm repo update cowboysysop\n\n  time helm upgrade --install flowise cowboysysop/flowise --version 3.11.3 \\\n    --namespace ${INSTANCE} \\\n    --set global.imageRegistry=\"${REGISTRY_MIRROR_URL}\" \\\n    --set image.tag=\"2.2.7\" \\\n    --set ingress.enabled=true \\\n    --set ingress.ingressClassName=\"nginx\" \\\n    --set ingress.hosts[0].host=\"${SSLIP_HOSTNAME}\" \\\n    --set ingress.hosts[0].paths[0]=\"/\" \\\n    --set ingress.tls[0].secretName=\"nai-cert\" \\\n    --set ingress.tls[0].hosts[0]=\"${SSLIP_HOSTNAME}\" \\\n    --wait\n done",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Install Milvus",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\n# Installing Milvus\n\nsource ~/.secrets\nsource ~/.env\n\nhelm repo add milvus https://zilliztech.github.io/milvus-helm/\nhelm repo update\n\ncd ~\nexport MILVUS_VALUES_FILE=\"milvus-values.yaml\"\nexport MILVUS_INGRESS_FILE=\"milvus-ingress.yaml\"\nexport MILVUS_ATTU_INGRESS_FILE=\"milvus-attu-ingress.yaml\"\n\n# Create Milvus config templates\ncat <<EOF > $MILVUS_VALUES_FILE\n#ATTU Frontend\nattu:\n  enabled: true\n  name: attu\n  service:\n    type: ClusterIP\n    port: 80\n\n# Milvus Cluster settings\ncluster:\n  enabled: false\n\netcd:\n  replicaCount: 1\n\npulsar:\n  enabled: false\n\nservice:\n  type: ClusterIP\n  ports:\n  - port: 80\n    protocol: TCP\n    targetPort: 19530\n\n# Disable MinIO and configuring External S3\nminio:\n  enabled: false\n\nexternalS3:\n  enabled: true\n  host: \"\" # Nutanix Objects Instance IP\n  port: 80\n  accessKey: \"\" # Access Key\n  secretKey: \"\" # Secret Key\n  useSSL: false\n  bucketName: \"docs\" # Bucket Name\n  rootPath: \"\"\n  region: us-east-1\n  useVirtualHost: false\nEOF\n\ncat <<EOF > $MILVUS_INGRESS_FILE\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: milvus-vectordb\n  annotations:\n    nginx.ingress.kubernetes.io/ssl-redirect: \"true\"\n    nginx.ingress.kubernetes.io/backend-protocol: \"GRPC\"\n    nginx.ingress.kubernetes.io/proxy-body-size: 100m\nspec:\n  ingressClassName: nginx\n  tls:\n  - hosts:\n    - hostname # the FQDN\n    secretName: nai-cert\n  rules:\n    - host: hostname\n      http:\n        paths:\n          - path: /\n            pathType: Prefix\n            backend:\n              service:\n                name: milvus-vectordb\n                port:\n                  number: 19530\nEOF\n\ncat <<EOF > $MILVUS_ATTU_INGRESS_FILE\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: milvus-vectordb-attu\n  annotations:\n    nginx.ingress.kubernetes.io/force-ssl-redirect: \"true\"\n    nginx.ingress.kubernetes.io/proxy-body-size: 2048m\nspec:\n  ingressClassName: nginx\n  tls:\n  - hosts:\n    - hostname # the FQDN\n    secretName: nai-cert\n  rules:\n    - host: hostname\n      http:\n        paths:\n          - path: /\n            pathType: Prefix\n            backend:\n              service:\n                name: milvus-vectordb-attu\n                port:\n                  number: 80\nEOF\n\necho \"Creating $NO_OF_USERS Milvus instances\"\n\nfor i in $(seq 1 $NO_OF_USERS)\ndo\n    export INSTANCE=\"milvus-adminuser0$i\"\n\n    kubectl create namespace ${INSTANCE} --dry-run=client -o yaml | kubectl apply -f -\n\n    # use the existing certificate\n    kubectl get secret -n nai-system nai-cert -o yaml | sed \"s/namespace: nai-system/namespace: ${INSTANCE}/g\" | kubectl apply -f -\n    kubectl get secret nai-cert -n ${INSTANCE}\n\n    export S3_BUCKET_NAME=\"adminuser0$i\"\n\n    # Update user-specific values\n    echo \"S3_HOST=$S3_HOST\"\n    echo \"S3_ACCESS_KEY=$S3_ACCESS_KEY\"\n    echo \"S3_SECRET_KEY=$S3_SECRET_KEY\"\n    echo \"S3_BUCKET_NAME=$S3_BUCKET_NAME\"\n    yq -i -e '.externalS3.host = strenv(S3_HOST)' $MILVUS_VALUES_FILE\n    yq -i -e '.externalS3.accessKey = strenv(S3_ACCESS_KEY)' $MILVUS_VALUES_FILE\n    yq -i -e '.externalS3.secretKey = strenv(S3_SECRET_KEY)' $MILVUS_VALUES_FILE\n    yq -i -e '.externalS3.bucketName = strenv(S3_BUCKET_NAME)' $MILVUS_VALUES_FILE\n\n    # Install\n    helm upgrade --cleanup-on-fail \\\n        --install milvus-vectordb milvus/milvus --version 4.2.44 \\\n        --set image.tag=\"2.5.8\" \\\n        --namespace ${INSTANCE} \\\n        --create-namespace \\\n        --wait \\\n        --values milvus-values.yaml\n\n    # Configure ingress\n    export INGRESS_IP=$(kubectl get svc ingress-nginx-controller -n ingress-nginx -o jsonpath=\"{.status.loadBalancer.ingress[].ip}\" && echo)\n    export DB_HOSTNAME=\"${INSTANCE}-${INGRESS_IP//./-}.sslip.nutanixdemo.com\"\n    export ATTU_HOSTNAME=\"${INSTANCE}-attu-${INGRESS_IP//./-}.sslip.nutanixdemo.com\"\n    yq -i -e \".spec.rules[0].host = strenv(DB_HOSTNAME)\" $MILVUS_INGRESS_FILE\n    yq -i -e \".spec.tls[0].hosts[0] = strenv(DB_HOSTNAME)\" $MILVUS_INGRESS_FILE\n    yq -i -e \".spec.rules[0].host = strenv(ATTU_HOSTNAME)\" $MILVUS_ATTU_INGRESS_FILE\n    yq -i -e \".spec.tls[0].hosts[0] = strenv(ATTU_HOSTNAME)\" $MILVUS_ATTU_INGRESS_FILE\n\n\n    kubectl apply -f $MILVUS_INGRESS_FILE -n ${INSTANCE}\n    kubectl apply -f $MILVUS_ATTU_INGRESS_FILE -n ${INSTANCE}\n    \n done",
                                            "script_type": "sh",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "ed89e085_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "ConfigureObjects",
                            "description": "",
                            "runbook": {
                                "name": "d7b831fa_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "7a207715_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "Configure Objects via Script",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "SET_VARIABLE",
                                        "name": "Configure Objects via Script",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "#!/usr/bin/env bash\nset -euo pipefail\nIFS=$'\\n\\t'\n\nsource ~/.env\n\n# Download and run script\n\ncurl -fsSL \"${OBJ_CONFIG_SCRIPT}\" | python",
                                            "script_type": "sh",
                                            "exit_status": [],
                                            "eval_scope": "local",
                                            "eval_variables": [
                                                "OBJECTS_URL",
                                                "SHARED_OBJECTS_SECRET_KEY",
                                                "SHARED_OBJECTS_ACCESS_KEY"
                                            ]
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "7a207715_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        },
                        {
                            "type": "user",
                            "name": "CleanupObjects",
                            "description": "",
                            "runbook": {
                                "name": "cab3d388_runbook",
                                "description": "",
                                "task_definition_list": [
                                    {
                                        "type": "DAG",
                                        "name": "ac02efa6_dag",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "edges": []
                                        },
                                        "child_tasks_local_reference_list": [
                                            {
                                                "name": "Cleanup Objects",
                                                "kind": "app_task"
                                            }
                                        ],
                                        "variable_list": [],
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    },
                                    {
                                        "type": "EXEC",
                                        "name": "Cleanup Objects",
                                        "description": "",
                                        "attrs": {
                                            "type": "",
                                            "script": "# Cleanup script to delete all objects access keys and user buckets created by blueprint\n\nPC_ADDRESS = \"@@{PC_ADDRESS}@@\"\nPC_PORT = \"@@{PC_PORT}@@\"\nPC_USERNAME = \"@@{CRED_PC.username}@@\" \nPC_PASSWORD = \"@@{CRED_PC.secret}@@\"\nDOMAIN = \"@@{DOMAIN}@@\"\nNUS_OBJ_NAME = \"@@{NUS_OBJ_NAME}@@\"\n\nimport requests, base64\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\n\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n\nBASIC_AUTH = \"{}:{}\".format(PC_USERNAME,PC_PASSWORD).encode(\"utf-8\")\nB64_AUTH = base64.b64encode(BASIC_AUTH).decode()\n\nPC_URL = \"https://{}:{}\".format(PC_ADDRESS,PC_PORT)\n\nHEADERS = {\n    \"Authorization\": \"Basic {}\".format(B64_AUTH),\n    \"Content-Type\": \"application/json\"\n}\n\ndef cleanup_bucket(objects_uuid=\"\",bucket_name=\"\"):\n    api_endpoint = \"/\".join([\n        PC_URL,\n        f\"oss/api/nutanix/v3/objectstore_proxy/{objects_uuid}/buckets/{bucket_name}\",]\n    )\n\n    try:\n        resp = requests.delete(\n            url=api_endpoint,\n            headers=HEADERS,\n            verify=False\n        )\n        resp.raise_for_status()\n\n    except requests.exceptions.HTTPError as err:\n        print(resp.text)\n        raise Exception(err)\n\n    print(f\"Bucket {bucket_name} deleted\")\n\n\ndef cleanup_access_keys(user_uuid=\"\", access_key_id=\"\"):\n    api_endpoint = \"/\".join([\n        PC_URL,\n        f\"oss/iam_proxy/users/{user_uuid}/buckets_access_keys/{access_key_id}\",])\n\n    try:\n        resp = requests.delete(\n            url=api_endpoint,\n            headers=HEADERS,\n            verify=False\n        )\n        resp.raise_for_status()\n\n    except requests.exceptions.HTTPError as err:\n        print(resp.text)\n        raise Exception(err)\n\ndef get_objects_instances():\n    api_endpoint = \"/\".join([\n        PC_URL,\n        \"oss/api/nutanix/v3/objectstores/list\",]\n    )\n\n    try:\n        resp = requests.get(\n            url=api_endpoint,\n            headers=HEADERS,\n            verify=False\n        )\n        resp.raise_for_status()\n\n        return resp.json()\n\n\n    except requests.exceptions.HTTPError as err:\n        print(resp.text)\n        raise Exception(err)\n        \ndef get_objects_instance_by_name(objects_instance_name):\n    objects_instances = get_objects_instances()\n\n    return next(\n        (objects for objects in objects_instances[\"specs\"] if objects[\"status\"][\"name\"] == objects_instance_name), \n        None)\n\ndef get_users():\n    api_endpoint = \"/\".join([\n        PC_URL,\n        f\"oss/iam_proxy/users?filter=has_buckets_access_key==true\",]\n    )\n\n    payload = {\n        \"offset\": 0,\n        \"length\": 20,\n    }\n\n    try:\n        resp = requests.get(\n            url=api_endpoint,\n            json=payload,\n            headers=HEADERS,\n            verify=False\n        )\n        resp.raise_for_status()\n        return resp.json()\n\n    except requests.exceptions.HTTPError as err:\n        print(resp.text)\n        raise Exception(err)\n\nobjects_instance = get_objects_instance_by_name(NUS_OBJ_NAME)\nobjects_uuid = objects_instance[\"metadata\"][\"uuid\"]\nusers = get_users()\n\n# Clean up created access key\nif users[\"length\"] > 0:\n    for i in range(0,users[\"length\"]):\n        user_uuid = users[\"users\"][i][\"uuid\"]\n        access_key_id = users[\"users\"][i][\"buckets_access_keys\"][0][\"access_key_id\"]\n        print(f\"Cleaning up User UUID: {user_uuid}\")\n        print(f\"Cleaning up Access Key ID: {access_key_id}\")\n        cleanup_access_keys(user_uuid=user_uuid, access_key_id=access_key_id)\n\n# Cleanup buckets for each user\nfor i in range(1,6):\n    cleanup_bucket(objects_uuid=objects_uuid,bucket_name=f\"adminuser0{i}\")",
                                            "script_type": "static_py3",
                                            "command_line_args": "",
                                            "exit_status": []
                                        },
                                        "child_tasks_local_reference_list": [],
                                        "variable_list": [],
                                        "target_any_local_reference": {
                                            "name": "Admin",
                                            "kind": "app_service"
                                        },
                                        "timeout_secs": "0",
                                        "retries": "0",
                                        "inherit_target": false,
                                        "status_map_list": []
                                    }
                                ],
                                "main_task_local_reference": {
                                    "name": "ac02efa6_dag",
                                    "kind": "app_task"
                                },
                                "variable_list": []
                            },
                            "critical": false
                        }
                    ],
                    "depends_on_list": [],
                    "port_list": [],
                    "singleton": false,
                    "tier": ""
                }
            ],
            "published_service_definition_list": [],
            "substrate_definition_list": [
                {
                    "type": "AHV_VM",
                    "name": "Admin_Substrate",
                    "description": "\n    Admin AHV Spec\n    Default 4 CPU & 16 GB of memory\n    ",
                    "variable_list": [],
                    "action_list": [],
                    "create_spec": {
                        "type": "",
                        "name": "@@{calm_application_name}@@-boot",
                        "availability_zone_reference": null,
                        "backup_policy": null,
                        "cluster_reference": {
                            "type": "",
                            "kind": "cluster",
                            "name": "RNO-SPOC002-4",
                            "uuid": "00064655-a13d-6729-6c5c-7cc2558db9fc"
                        },
                        "resources": {
                            "type": "",
                            "nic_list": [
                                {
                                    "type": "",
                                    "nic_type": "NORMAL_NIC",
                                    "subnet_reference": {
                                        "type": "",
                                        "kind": "subnet",
                                        "name": "primary",
                                        "uuid": "03d54553-5335-449d-9d27-d24555b04ecf"
                                    },
                                    "network_function_nic_type": "INGRESS",
                                    "mac_address": "",
                                    "ip_endpoint_list": [],
                                    "network_function_chain_reference": null,
                                    "vpc_reference": null
                                }
                            ],
                            "power_state": "ON",
                            "guest_tools": null,
                            "num_vcpus_per_socket": 1,
                            "num_sockets": 4,
                            "memory_size_mib": 8192,
                            "gpu_list": [],
                            "parent_reference": null,
                            "hardware_clock_timezone": "",
                            "account_uuid": "e4ad82cb-db93-4d09-82d0-6166507d0074",
                            "guest_customization": {
                                "type": "",
                                "cloud_init": {
                                    "type": "",
                                    "meta_data": "",
                                    "user_data": "#cloud-config\nhostname: @@{name}@@\nfqdn: \"@@{name}@@.@@{DOMAIN}@@\"\nprefer_fqdn_over_hostname: true\nmanage_etc_hosts: true\nssh_pwauth: true\nchpasswd:\n  expire: false\n  users:\n    - name: @@{CRED_SSH.username}@@\n      password: @@{SSH_PASSWORD}@@\n      type: text\nusers:\n- name: @@{CRED_SSH.username}@@\n  shell: /bin/bash\n  ssh_authorized_keys:\n  - @@{CRED_SSH.public_key}@@\n  sudo: ALL=(ALL) NOPASSWD:ALL\nruncmd:\n- '[ ! -f \"/etc/yum.repos.d/nutanix_rocky9.repo\" ] || mv -f /etc/yum.repos.d/nutanix_rocky9.repo /etc/yum.repos.d/nutanix_rocky9.repo.disabled'\n- dnf config-manager --add-repo https://download.docker.com/linux/rhel/docker-ce.repo\n- dnf -y install docker-ce docker-ce-cli containerd.io\n- systemctl --now enable docker\n- usermod -aG docker nutanix\n- 'curl -Lo /usr/local/bin/kubectl https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl'\n- chmod +x /usr/local/bin/kubectl\n- 'curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash'\n- [pip, install, python-dotenv, boto3]\n- eject"
                                },
                                "sysprep": null
                            },
                            "boot_config": {
                                "type": "",
                                "boot_device": {
                                    "type": "",
                                    "disk_address": {
                                        "type": "",
                                        "device_index": 0,
                                        "adapter_type": "SCSI"
                                    }
                                },
                                "mac_address": "",
                                "boot_type": ""
                            },
                            "vtpm_config": null,
                            "disk_list": [
                                {
                                    "type": "",
                                    "data_source_reference": {
                                        "type": "",
                                        "kind": "image",
                                        "name": "nkp-rocky-9.6-release-cis-1.33.5-20251108010758.qcow2",
                                        "uuid": "91a02a00-f249-462b-841b-1fe1f2f8a7c2"
                                    },
                                    "volume_group_reference": null,
                                    "device_properties": {
                                        "type": "",
                                        "disk_address": {
                                            "type": "",
                                            "device_index": 0,
                                            "adapter_type": "SCSI"
                                        },
                                        "device_type": "DISK"
                                    },
                                    "disk_size_mib": 81920
                                }
                            ],
                            "serial_port_list": []
                        },
                        "categories": {}
                    },
                    "os_type": "Linux",
                    "readiness_probe": {
                        "login_credential_local_reference": {
                            "name": "CRED_SSH",
                            "kind": "app_credential"
                        },
                        "connection_type": "SSH",
                        "connection_port": 22,
                        "delay_secs": "60",
                        "retries": "5",
                        "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@",
                        "disable_readiness_probe": false,
                        "connection_protocol": ""
                    }
                }
            ],
            "package_definition_list": [
                {
                    "type": "CUSTOM",
                    "name": "Admin_Package",
                    "description": "\n    Package install for Admin\n    ",
                    "variable_list": [],
                    "action_list": [],
                    "service_local_reference_list": [
                        {
                            "name": "Admin",
                            "kind": "app_service"
                        }
                    ],
                    "version": "",
                    "options": {
                        "type": "",
                        "install_runbook": {
                            "name": "Admin_Package___install___runbook",
                            "description": "",
                            "task_definition_list": [
                                {
                                    "type": "DAG",
                                    "name": "Admin_Package___install___dag",
                                    "description": "",
                                    "attrs": {
                                        "type": "",
                                        "edges": []
                                    },
                                    "child_tasks_local_reference_list": [
                                        {
                                            "name": "Package Install",
                                            "kind": "app_task"
                                        }
                                    ],
                                    "variable_list": [],
                                    "target_any_local_reference": {
                                        "name": "Admin",
                                        "kind": "app_service"
                                    },
                                    "timeout_secs": "0",
                                    "retries": "0",
                                    "inherit_target": false,
                                    "status_map_list": []
                                },
                                {
                                    "type": "CALL_RUNBOOK",
                                    "name": "Package Install",
                                    "description": "",
                                    "attrs": {
                                        "type": "",
                                        "runbook_reference": {
                                            "name": "Admin_PackageInstall_runbook",
                                            "kind": "app_runbook"
                                        },
                                        "inarg_list": []
                                    },
                                    "child_tasks_local_reference_list": [],
                                    "variable_list": [],
                                    "target_any_local_reference": {
                                        "name": "Admin",
                                        "kind": "app_service"
                                    },
                                    "timeout_secs": "0",
                                    "retries": "0",
                                    "inherit_target": false,
                                    "status_map_list": []
                                }
                            ],
                            "main_task_local_reference": {
                                "name": "Admin_Package___install___dag",
                                "kind": "app_task"
                            },
                            "variable_list": []
                        },
                        "uninstall_runbook": {
                            "name": "Runbook_for_Package_Admin_Package_action_uninstall",
                            "description": "",
                            "task_definition_list": [
                                {
                                    "type": "DAG",
                                    "name": "DAG_Task_for_Package_Admin_Package_action_uninstall",
                                    "description": "",
                                    "attrs": {
                                        "type": "",
                                        "edges": []
                                    },
                                    "child_tasks_local_reference_list": [],
                                    "variable_list": [],
                                    "target_any_local_reference": {
                                        "name": "Admin",
                                        "kind": "app_service"
                                    },
                                    "timeout_secs": "0",
                                    "retries": "0",
                                    "inherit_target": false,
                                    "status_map_list": []
                                }
                            ],
                            "main_task_local_reference": {
                                "name": "DAG_Task_for_Package_Admin_Package_action_uninstall",
                                "kind": "app_task"
                            },
                            "variable_list": []
                        },
                        "upgrade_runbook": {}
                    }
                }
            ],
            "app_profile_list": [
                {
                    "name": "Nutanix",
                    "description": "",
                    "variable_list": [
                        {
                            "type": "LOCAL",
                            "name": "MANAGEMENT_WORKSPACE_APPS",
                            "description": "This need to be updated with every new release. Command to list apps is kubectl get clusterapps. The format of the list is to use comma to separate appdeployment and app name, and the space to separate different apps\n\nold:\nistio,istio-1.23.3 knative,knative-1.17.0",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Apps to additionally enable in the Management Workspace",
                            "attrs": {
                                "type": ""
                            },
                            "value": "nkp-insights,nkp-insights-1.6.9 nvidia-gpu-operator,nvidia-gpu-operator-25.3.3"
                        },
                        {
                            "type": "LOCAL",
                            "name": "DEFAULT_WORKSPACE_APPS",
                            "description": "This need to be updated with every new release. Command to list apps is kubectl get clusterapps. The format of the list is to use comma to separate appdeployment and app name, and the space to separate different apps",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Apps to enable by default in Default Workspace",
                            "attrs": {
                                "type": ""
                            },
                            "value": "grafana-logging,grafana-logging-8.9.0 grafana-loki,grafana-loki-0.79.5 kube-prometheus-stack,kube-prometheus-stack-69.1.2 kubecost,kubecost-2.5.2 kubernetes-dashboard,kubernetes-dashboard-7.10.3 logging-operator,logging-operator-5.0.1 nkp-insights-management,nkp-insights-management-1.4.4 prometheus-adapter,prometheus-adapter-4.11.0 rook-ceph,rook-ceph-1.16.2 rook-ceph-cluster,rook-ceph-cluster-1.16.2"
                        },
                        {
                            "type": "LOCAL",
                            "name": "CSI_FILE_SERVER_NAME",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Files instance name for CSI",
                            "attrs": {
                                "type": ""
                            },
                            "value": "unused"
                        },
                        {
                            "type": "LOCAL",
                            "name": "CSI_FILE_SERVER_ENABLE",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": [
                                    "false",
                                    "true"
                                ]
                            },
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Enable Files CSI",
                            "attrs": {
                                "type": ""
                            },
                            "value": "false"
                        },
                        {
                            "type": "LOCAL",
                            "name": "STORAGE_CONTAINER_NAME",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "PE storage container for CSI Volumes",
                            "attrs": {
                                "type": ""
                            },
                            "value": "SelfServiceContainer"
                        },
                        {
                            "type": "LOCAL",
                            "name": "CONTAINER_REGISTRY_MIRROR",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Registry mirror",
                            "attrs": {
                                "type": ""
                            },
                            "value": "registry.nutanixdemo.com/bootcamps"
                        },
                        {
                            "type": "LOCAL",
                            "name": "REGISTRY_MIRROR_ENABLE",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": [
                                    "false",
                                    "true"
                                ]
                            },
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Enable private registry mirror",
                            "attrs": {
                                "type": ""
                            },
                            "value": "true"
                        },
                        {
                            "type": "SECRET",
                            "name": "SSH_PASSWORD",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Linux SSH password",
                            "attrs": {
                                "type": "",
                                "is_secret_modified": false,
                                "secret_reference": {}
                            },
                            "value": "un604DwLablptTl2ixNU3EZ/RWdvT0o8+adIPHsv80SfftYf9HDJmsxIAQ==:utf-8"
                        },
                        {
                            "type": "SECRET",
                            "name": "NKP_LICENSE_KEY",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "NKP license key",
                            "attrs": {
                                "type": "",
                                "is_secret_modified": false,
                                "secret_reference": {}
                            },
                            "value": "Nmrn6L65JNfpWKOJIrK1brc+9dSHNgY4et+X1/iY2JdH/xKR7xEO1fqOuTS6zUMfPsyeJxJuJy6NTyTPEv9y93ZCBjqCCiAk5Q==:utf-8"
                        },
                        {
                            "type": "LOCAL",
                            "name": "DOMAIN",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "AD domain",
                            "attrs": {
                                "type": ""
                            },
                            "value": "ntnxlab.local"
                        },
                        {
                            "type": "LOCAL",
                            "name": "MGMT_LB_IP_RANGE_USERS_ENDS",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": true,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "External IPs for users LB services",
                            "attrs": {
                                "type": ""
                            },
                            "value": "10.8.31.35"
                        },
                        {
                            "type": "LOCAL",
                            "name": "MGMT_LB_IP_RANGE_USERS_STARTS",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": true,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "External IPs for users LB services",
                            "attrs": {
                                "type": ""
                            },
                            "value": "10.8.31.24"
                        },
                        {
                            "type": "LOCAL",
                            "name": "MGMT_LB_IP_RANGE_ENDS",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": true,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "NKP Apps VIP for MetalLB",
                            "attrs": {
                                "type": ""
                            },
                            "value": "10.8.31.15"
                        },
                        {
                            "type": "LOCAL",
                            "name": "MGMT_LB_IP_RANGE_STARTS",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": true,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "NKP Apps VIP for MetalLB",
                            "attrs": {
                                "type": ""
                            },
                            "value": "10.8.31.15"
                        },
                        {
                            "type": "LOCAL",
                            "name": "CONTROL_PLANE_VIP_ADDRESS",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": true,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Control Plane VIP address",
                            "attrs": {
                                "type": ""
                            },
                            "value": "10.8.31.14"
                        },
                        {
                            "type": "LOCAL",
                            "name": "NKP_BINARY_URL",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": true,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "URL for NKP CLI tarball",
                            "attrs": {
                                "type": ""
                            },
                            "value": "http://10.8.1.18/vx-images/nkp_v2.16.1_linux_amd64.tar.gz?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=sY69J5-JrGDfVDo7vnodrNfFyVLNmCTL%2F20251219%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251219T224258Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=5e0097f0927d12d5b61f1f55a3677672f2e82a730096a2403bba5b8f6a3ede8e"
                        },
                        {
                            "type": "LOCAL",
                            "name": "BINDDN",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "LDAP Bind User",
                            "attrs": {
                                "type": ""
                            },
                            "value": "cn=Administrator,cn=Users,dc=ntnxlab,dc=local"
                        },
                        {
                            "type": "SECRET",
                            "name": "BINDPW",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "LDAP Bind User Password",
                            "attrs": {
                                "type": "",
                                "is_secret_modified": false,
                                "secret_reference": {}
                            },
                            "value": "/U5wMt6j50bZIO8WUo/usiD2ocewdnxsecztOnfpADcNcOWtn2PXspiIdw==:utf-8"
                        },
                        {
                            "type": "LOCAL",
                            "name": "LDAP_HOST",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": true,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "LDAP Host",
                            "attrs": {
                                "type": ""
                            },
                            "value": "10.8.31.6"
                        },
                        {
                            "type": "LOCAL",
                            "name": "LDAP_PORT",
                            "description": "",
                            "regex": {
                                "value": "^[\\d]*$",
                                "should_validate": false
                            },
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "INT",
                            "label": "LDAP Port",
                            "attrs": {
                                "type": ""
                            },
                            "value": "636"
                        },
                        {
                            "type": "LOCAL",
                            "name": "NO_SSL",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": [
                                    "false",
                                    "true"
                                ]
                            },
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "NO SSL",
                            "attrs": {
                                "type": ""
                            },
                            "value": "false"
                        },
                        {
                            "type": "LOCAL",
                            "name": "SKIP_SSL_VERIFICATION",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": [
                                    "false",
                                    "true"
                                ]
                            },
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Skip SSL verification",
                            "attrs": {
                                "type": ""
                            },
                            "value": "true"
                        },
                        {
                            "type": "LOCAL",
                            "name": "START_TLS",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": [
                                    "false",
                                    "true"
                                ]
                            },
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Start TLS",
                            "attrs": {
                                "type": ""
                            },
                            "value": "false"
                        },
                        {
                            "type": "LOCAL",
                            "name": "LDAP_SEARCH_USERS",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "LDAP Search Users Path",
                            "attrs": {
                                "type": ""
                            },
                            "value": "cn=Users,dc=ntnxlab,dc=local"
                        },
                        {
                            "type": "LOCAL",
                            "name": "LDAP_SEARCH_GROUPS",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "LDAP Search Groups Path",
                            "attrs": {
                                "type": ""
                            },
                            "value": "cn=Users,dc=ntnxlab,dc=local"
                        },
                        {
                            "type": "LOCAL",
                            "name": "CLUSTER_NAME",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "NKP cluster name",
                            "attrs": {
                                "type": ""
                            },
                            "value": "nkp"
                        },
                        {
                            "type": "LOCAL",
                            "name": "PC_ADDRESS",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": true,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Prism Central IP address",
                            "attrs": {
                                "type": ""
                            },
                            "value": "10.8.31.7"
                        },
                        {
                            "type": "LOCAL",
                            "name": "PC_PORT",
                            "description": "",
                            "regex": {
                                "value": "^[\\d]*$",
                                "should_validate": false
                            },
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "INT",
                            "label": "Prism Central Port",
                            "attrs": {
                                "type": ""
                            },
                            "value": "9440"
                        },
                        {
                            "type": "LOCAL",
                            "name": "MACHINE_TEMPLATE_IMAGE_NAME",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Template name",
                            "attrs": {
                                "type": ""
                            },
                            "value": "nkp-rocky-9.6-release-cis-1.33.5-20251108010758.qcow2"
                        },
                        {
                            "type": "LOCAL",
                            "name": "PRISM_ELEMENT_CLUSTER_NAME",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": true,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Prism Element cluster name",
                            "attrs": {
                                "type": ""
                            },
                            "value": "RNO-SPOC002-4"
                        },
                        {
                            "type": "LOCAL",
                            "name": "PE_VIP_ADDRESS",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": true,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Prism Element cluster IP",
                            "attrs": {
                                "type": ""
                            },
                            "value": "10.8.31.37"
                        },
                        {
                            "type": "LOCAL",
                            "name": "SUBNET_NAME",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Subnet name",
                            "attrs": {
                                "type": ""
                            },
                            "value": "primary"
                        },
                        {
                            "type": "SECRET",
                            "name": "NUS_FS_API_PASSWORD",
                            "description": "",
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Files API password",
                            "attrs": {
                                "type": "",
                                "is_secret_modified": false,
                                "secret_reference": {}
                            },
                            "value": "wa0OFAiqMqQeNw4GkoOXWXiZ9idRP4YpbTzEgyZzOB5adrFyfNdwkn6Mcg==:utf-8"
                        },
                        {
                            "type": "LOCAL",
                            "name": "NUS_FS_API_USER",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "Files API user",
                            "attrs": {
                                "type": ""
                            },
                            "value": "csi"
                        },
                        {
                            "type": "LOCAL",
                            "name": "NUS_FS_NAME",
                            "description": "",
                            "is_hidden": true,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": "files"
                        },
                        {
                            "type": "LOCAL",
                            "name": "NAI_CORE_VERSION",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": "2.5"
                        },
                        {
                            "type": "SECRET",
                            "name": "HF_TOKEN",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": "SECRET",
                                "is_secret_modified": false,
                                "secret_reference": {}
                            },
                            "value": "/J8Vq+e4iaX612CvSnyApp+AnNC2pI33UDuBF82YcQxVxh3jVWFTKqQr9oD2cdQJ9mnNJx6GcKpKgpCO1HF/RLe55R7y:utf-8"
                        },
                        {
                            "type": "SECRET",
                            "name": "NAI_NEW_USER_PW",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": "SECRET",
                                "is_secret_modified": false,
                                "secret_reference": {}
                            },
                            "value": "tTiRqOasXngFkp/jsnAqv266S+kMWAR1dUOb7bFjSMBI8Vex7kj2BsgfHg==:utf-8"
                        },
                        {
                            "type": "SECRET",
                            "name": "NAI_DEFAULT_PW",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": "SECRET",
                                "is_secret_modified": false,
                                "secret_reference": {}
                            },
                            "value": "tbCcn5QxexUHWTQWyEwWgAX03BVbT6EhoHgitH612Mc4HxVO6WwHWHVa0Q==:utf-8"
                        },
                        {
                            "type": "SECRET",
                            "name": "NAI_NEW_ADMIN_PW",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": "SECRET",
                                "is_secret_modified": false,
                                "secret_reference": {}
                            },
                            "value": "sO9FxXHOaOP+R1TgEOuYOHIeAX4BAz6mKhmva8f9noqxf/fA8owBuizZBsoU:utf-8"
                        },
                        {
                            "type": "LOCAL",
                            "name": "NUS_OBJ_NAME",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": "objects"
                        },
                        {
                            "type": "LOCAL",
                            "name": "CONTAINER_REGISTRY_USERNAME",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": "admin"
                        },
                        {
                            "type": "SECRET",
                            "name": "CONTAINER_REGISTRY_PASSWORD",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": "SECRET",
                                "is_secret_modified": false,
                                "secret_reference": {}
                            },
                            "value": "MzlinFn7I8wrq/k7FiblvcJjUU2g9/CMSxTNSbJIxCduwUNaYz1HXAy+0oFcPw==:utf-8"
                        },
                        {
                            "type": "SECRET",
                            "name": "NAI_LICENSE_UUID",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": "SECRET",
                                "is_secret_modified": false,
                                "secret_reference": {}
                            },
                            "value": "klHtoPuuH/dvhROB2/RPL/74Q4K0jug3AAUEF/1PkdxT6DZODO108HEX/7qtQOLGPLgiYL8o5sC1j5EYporNieGFlj8=:utf-8"
                        },
                        {
                            "type": "SECRET",
                            "name": "NAI_LICENSE_KEY",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": "SECRET",
                                "is_secret_modified": false,
                                "secret_reference": {}
                            },
                            "value": "Jr/abKf+gcXJ/wWNnkSya4dw2+LgmWmpOwswzaOb22QPctsVXLTYI5ZDkmy9sffdMnRuqV5bJxNp1xI59DV6VRK0u2ib7Tp5fw==:utf-8"
                        },
                        {
                            "type": "LOCAL",
                            "name": "OBJ_CONFIG_SCRIPT",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": "http://10.8.1.18/vx-images/nai_bootcamp_configure_objects.py?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=sY69J5-JrGDfVDo7vnodrNfFyVLNmCTL%2F20251219%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251219T224258Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=7a808ebe101e4e1f705797ded7de7e0beb1c4683537719e03979029ad88ff2ff"
                        },
                        {
                            "type": "LOCAL",
                            "name": "NAI_IMAGE_REGISTRY",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": "registry.nutanixdemo.com/nai"
                        },
                        {
                            "type": "LOCAL",
                            "name": "NO_OF_USERS",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": "5"
                        },
                        {
                            "type": "LOCAL",
                            "name": "NO_OF_WORKER_NODES",
                            "description": "",
                            "options": {
                                "type": "PREDEFINED",
                                "choices": []
                            },
                            "is_hidden": false,
                            "is_mandatory": false,
                            "data_type": "BASE",
                            "val_type": "STRING",
                            "label": "",
                            "attrs": {
                                "type": ""
                            },
                            "value": "6"
                        }
                    ],
                    "action_list": [],
                    "deployment_create_list": [
                        {
                            "type": "GREENFIELD",
                            "name": "Admin_Deployment",
                            "description": "",
                            "variable_list": [],
                            "action_list": [],
                            "depends_on_list": [],
                            "min_replicas": "1",
                            "max_replicas": "1",
                            "default_replicas": "",
                            "package_local_reference_list": [
                                {
                                    "name": "Admin_Package",
                                    "kind": "app_package"
                                }
                            ],
                            "substrate_local_reference": {
                                "name": "Admin_Substrate",
                                "kind": "app_substrate"
                            },
                            "options": {
                                "type": ""
                            },
                            "published_service_local_reference_list": []
                        }
                    ],
                    "snapshot_config_list": [],
                    "restore_config_list": [],
                    "environment_reference_list": [],
                    "application_url": "",
                    "patch_list": []
                }
            ],
            "credential_definition_list": [
                {
                    "type": "KEY",
                    "name": "CRED_SSH",
                    "description": "",
                    "editables": {
                        "username": false,
                        "secret": true
                    },
                    "username": "nutanix",
                    "secret": {
                        "attrs": {
                            "secret_reference": {},
                            "is_secret_modified": true
                        },
                        "value": "MUaHvp9xESGg29t7/HGmn0xhe+PjuM2r3MNbhZBS5rwyN8gpnEgyy501ZgcAw/UuL/tQe9Wd2MvakcHUwXLP02/N/wC5cxUA+9gYUz3fUCv4K2js3KA8uT24BmDZMpDMnuSwWzPMTM95XNsJm/W5J0nfp0Jcb8CfH+ZxIJKrx9/XDqycWtF0s3dWNr+vSyZFnKfXrgFN14G0TcaAx/HlC22kLbO7JxxzaIYSPo6GnaWxZl/74i4T6v5LPeBaIjC6pIZ11qJYW1Anu/p1MPFDFsbk7zUW7fdAZYhJqyBKLJntwqcx+lzpK8W5LAL0D53l+Kpilx5kbfg/d5E43ct+zvL0ufmGq64Qxg3NXvz+KrtaMRXFdN2RY424bmZlKRj6C/zeAmgd2CMYtoU/Lr15XBphCli5I1KpPVLofrNdvbU/Ufgr6Yvfp8BSN/Cp8AuRJcuoPSAQHRUZsSNZ+COSjzYfVz5XXS4V4xCIG8+Spid6PIAfPijZf6NGqJVc0sqh7sx2ZifR2B4BHboXC/5lV1cWTZNNLxqeNRJvEUiTghw/pITbn31oi9hom+y8VhS6i7udVxyFLWoEBOGm6gB8/Knp0UcpASV9kWYqnG/QcMHGj1hpgsD6CEluyGKnF9BTdQ04yvx0mEfJNYQ4Rz3LqJ9TXiW8U/r2z/YbIAG8PgmmAlm1rLK6QoNh0iCq+0s9s6J/PgdymRjzJwyMGvZnBxsswjkUXZ8VfjUIGNauEiFyJs0CxnO7XLbud4SWK20BK9ASqjUG7d96I5wge4ebXEW7FvvCKAjriKj1/vf3ehwj6G8urQfoe5ybU1sk0fdslmdxz47XyNWTDbCTnZtPSNsFfAMcifegjNF8sxtOfqH2Y51lqpGciQMES/7W9tIQC9QuOpI3D3EzJWZj2Un9kS75+v92+KhnzY7KhgxaesZ2TOhWi5mWkw6lj6kNhkE/ie34jXTSI3arYoSbbUOmSXp2LeKURtE6bWXnjS0x577f1Ce8cCgbUPLtIY/hswcZ1wND+QOZ3z6TvAFvwxLLgTAukh1NMex7YDulpZU7aDpg0KN45kqK2TSmLDMWGvFp5amaMyUAzlmtUDRWoWnJtDV0yK6k1s//ODm14SmfcnZm2NBHqiMz7AtH0u80s4a8pc4vrtsLp4dIYqbBG6D5YNIMOYt6KNUVkaBh5KPCsXzfCYXZQcFPhwcvA/2s9av2VauTfYJARwNcjvqezIoVN/chySwlJ16WcAL67dgWVnl3VePwEbMBBx/ffUQ5SmfzHvSUpUNVYhaO5ioHoTK6v9WGDzfhMD9iLqh74rXYqttsmV55ELJ08zi83HYtf1PHLwEe+lQqOmBXGDhe2f4YLNpZX7azuWp7yEPe5IG3WFHirD7/6V4nAmxYIEqOUBY3XbqIba4xe05Fa9v8cmhBpqUD2pdnURyR3ATNB0ruElFP3ao1PpLiC+uYtCRL/g4aGE22IqojlMJC7EdIyZSdoUzpzma1eglzLA1pjwhpaXlcbr7GMiqrmeh1u24Cw3YgjtUxz7NudqXIbQCG/KuSTSrm9KMOczHTbngnERXGfEDc7NtFfimJYpUnV0Hr8r3diOmlr3UCQUtyzXqi31ThkV50W9pVpDzfyR5fK1jB+I/lrOg3thaVZI3jqITYykpsoAWQUHfe2w+By7pAbJ4F8VRbW3Yl0YEMwfGwyl0TzHS0UxPxBmqHxS+3Rl7k+ARTF5Jv2lWm1p+SsA53R6Vx0PzRl4M9smZ9f1GlLBZ6WJ+XXnb03+IGbQcCcm9J4fmBDoFMzWjc7oG2HGIZhPeWCgVphGJuM62GQPPKf47QiGrwr+pcN3egkrEbcU4pcMXw4T9XSHDLhAbr9WirCsRYch6/vguwKpMgN7g//7T0wDrUnLoJhJT+iBFKQr7+FdX6NPQEfF/GXt8QGH9fZSOd2gvQ3CCA9v57vVG6GLLHMB/OmNvcBMb/xsjTDveMdCm0P7qiakMN2JUwxpDRUpqlbR/lAhoRrcPraImKmrGmAF0hBOd0wHhPeLXb8YL4e+65MFSBJ1pldBRed/++sD/GbY/KgG5+rAceUWf/FIYihR1wuVSmU1B4+wEjCa15c2x6gDmpl1jYii+DpcdPoeGUxjrGTwYKkxikFKCYWxsDnx3SxspiBTktYEnm4xTALwAQMg37ZhKW2De5I0OwvaErzexS0KJS92HAv0WqgTzdq8enVJoFUi5VF5nr1gz4gMwHQq0MKpeg5SpK6L85He/q2ELpJs0FTR6DjPOlnZPjVHIS6040hqIb999dJSP5Z51wZSLgiWxb5zVH3XonDMzHbH26ScOqr8Fz5N9MbLKia8orQW7OcU01434xavM/npuN/IqhwW9Qmt7aqeV8YnaRHylrf1b9UvzHkGQe6Fvd+ZjYpnvWVUXUokv8yGNXUrj3JWbCu3qHicfoWVpJ2YG6F2p+POPdQ9ckPqJIH4IT4FBcYr1yZ36S/vTqQwjFT90mdJcCAtU4VPRE20rf8RhhnzH9poZX7OEdJdgQgM/ZWJEWkUgJhSVhMe8aBTIGPdDCwc5NNXgnZDhwv524lm8B/dY3Ly3J73T56QyqAGIRKgelMUMSA4R0/t7AdHELOtDl37fZxvM42PKSND1geLZnhLga2agZMSmV69QPN/4rGYIc0wsCzgWV3bNZZRuyFtjLfc4KS2aSJYp/uBW5pmQleXHcIXLpKyp0GKyGSHTU+QYBRFxDZT7eTzvbZsPDi5/yXgF6Uf6CCHlAfiSY3uMeV3htE5V7RiXZNRfKnp5OcBX0okYoNmjKAVm7BuzNT1DrVsTyoqY6+n549jPOGJOoV0uOl2unfPO0RkXudEVQ6+MU4+e4pgwJOe4LkRlDLzWWxhVuvGHL5h9aXIye0mF6ASy6WJ4XuFCN5jbnK2cxwIcaUhF2hQvDeDNJd3lOpol5CLUzP0PtaexwMP8zR3kcoZo4CsIzIqdLUJaidq/iEZca5rx57St/8/PlKmVU31kJpysGZG9PAFRlP7iCtfMDleOJMpAX8KdKbv3FePmy+XdfDRPUJ8oZodIg8BuQGt+GbMXGMefyfgKwn543rIwkpIOwf1KePryMLepmbV7jXlLdIDB702/QxfqUUVi9sWW1oFBWPrBHVK1wXTnseHtk32CH6cjM57DECDeooteGiK1kKpCyuYzEnk2FMGbmmvz4JmrD4CefdvAW4mEzWkcaCMO6B7rTWcUh5tUs42SE8+Tb4lYeQRov1H2rFLjHOFJAB+wn2s6yyMV9btf5tM8i0hmZ/s/x9rjZ2VkgHuxDC5k/dBqmi9NkWTQGg+AjyS5lEQ0St8fdNemq7qIfZXHD5zJ9E66h7vDbuYQCUVvXyWlQAZZuDtkP70s921QF2+OSTDcKDsvRUSE7mU9ZbD+7Th0XFopt4eWNfc+mVkK4/X7N2g3dBq8PhngkW8wHFrDmbL0C8QzXMDkveJQHjc9+SpJrFBxbAGaJAjzWBYatAchMrTjaYIHVF/qjh6O/wV9ZvlDRn18659CW+Vnu1aJJS709Qw5OVeR7FsJjLqJ6dLhfwgI6lX+/bgsTeoipzn/djCrxfflhkht6gW0X3RtlNeUBLtN7CaEiQoEm9ufVuznoZORFi5agEssfA/IeuaZ8ualim56Avz30kR6k+WCl8nVNmp0QyoTk+YNFZv/SH0EcW87vcas64+urThKzNCpmfoXOBZgOnZ0rg2ozMLRTDNIIa55joMQmhdpdmHIVtWmg602+Hy5w0rAomWgpSHHzRf78nweZl2umA+dEkultvZbtbbfOwvziB3wLmdq1VdTfUz1Z3GxGUt1qLAOF+ixvaSYSkS1eGG0IuMI6hXfZGjrpR4fnzh7K7pENcUiBwsIlsZgH2z5fAci1mWgruP6/iW/5Ss1adTWuilvRnuLibnRBHeep0/Ypdx+n4BbYWgJsaLPjPMu56cZZHiGazROIyjvIAexFVg7+w7x+h08Vrcup2blN5bPNk370X5ED4OwOrWy5mk3rwQDXFONfq7Ncpw2Kw4M0s8xxCnlWkymVX1rwcm/GQu8V38nMPB4OlP4tNbdqJtNR4S2rQkX6xmJ294+00ptQYmaULAaYeGVmycL4tI052StnxIsXlfkMkWdWzlWLziYR3Iq9XSxk7Bv8UMQuQ+X79A+pnuRFzCYf4cqh7BRt9FP9FjXFofO29xzppo39LOsfoKPGRr+KiX8NM1Oiexw8NSvWuzSKpd2Wh46jCZzo9LWSYs5w7t7LeAFHHzVZNkeVz4o7DQz1ivHawUSgyO6EQYA9fVz6hrXn8wuMJJmaNba07HHR8eg6Smw97ex5XR2+22jlwgfKKD21+pN4Dh3n/tUqvIxCOBoU:utf-8"
                    },
                    "cred_class": "static"
                },
                {
                    "type": "PASSWORD",
                    "name": "CRED_PC",
                    "description": "",
                    "editables": {
                        "username": false,
                        "secret": true
                    },
                    "username": "admin",
                    "secret": {
                        "attrs": {
                            "secret_reference": {},
                            "is_secret_modified": true
                        },
                        "value": "KidH/JUGvoEj+DREUyU0KNNtJ7MMXlqfvk4rXr6b4+Js209SKjYFMkpwJA==:utf-8"
                    },
                    "cred_class": "static"
                }
            ],
            "default_credential_local_reference": {
                "name": "CRED_SSH",
                "kind": "app_credential"
            },
            "type": "USER",
            "client_attrs": {
                "null": {
                    "Service": {
                        "Admin": {
                            "dsl_name": "Admin",
                            "Action": {}
                        }
                    },
                    "Package": {
                        "Admin_Package": {
                            "dsl_name": "Admin_Package",
                            "Action": {}
                        },
                        "NKP_213_ROCKY_95": {
                            "dsl_name": "NKP_213_ROCKY_95",
                            "Action": {}
                        }
                    },
                    "Deployment": {
                        "Admin_Deployment": {
                            "dsl_name": "Admin_Deployment",
                            "Action": {}
                        }
                    },
                    "Profile": {
                        "Nutanix": {
                            "dsl_name": "Nutanix",
                            "Action": {}
                        }
                    },
                    "Substrate": {
                        "Admin_Substrate": {
                            "dsl_name": "Admin_Substrate",
                            "Action": {},
                            "AhvVm": {
                                "@@{calm_application_name}@@-boot": {
                                    "dsl_name": "Admin_AhvVm"
                                }
                            }
                        }
                    }
                },
                "Admin_Deployment": {
                    "x": -1368.7943125477873,
                    "y": -701.4442415638308
                }
            },
            "global_variable_reference_list": []
        }
    },
    "api_version": "3.0",
    "product_version": "4.3.0",
    "metadata": {
        "last_update_time": "1766443771623938",
        "creation_time": "1766190787305592",
        "spec_version": 5,
        "name": "nai-on-nkp-v2-5",
        "kind": "blueprint"
    },
    "contains_secrets": true
}